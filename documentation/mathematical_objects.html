<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>Project Chrono: Mathematical objects in Chrono</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://projectchrono.org">
            <span class="logo first">PROJECT</span><span class="logo second">CHRONO</span>
        </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://projectchrono.org/download">Download</a></li>
        <li class="dropdown">
            <a href="http://api.chrono.projectchrono.org" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://api.chrono.projectchrono.org/faq_root.html">FAQ</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_table_of_content_install.html">Install Guide</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_root.html">Examples/Tutorials</a></li>
                <li><a href="http://api.chrono.projectchrono.org/model_root.html">Model Library</a></li>
                <li><a href="http://api.chrono.projectchrono.org/validation_studies_root.html">Validation Studies</a></li>
                <li><a href="http://api.chrono.projectchrono.org/whitepaper_root.html">White Papers</a></li>
                <li><a href="http://projectchrono.org/docpdf">PDF Version</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="http://projectchrono.org/gallery/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" style="dropdown:hover" aria-haspopup="true" aria-expanded="false">Movies <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/gallery/">Gallery</a></li>
                <li><a href="http://sbel.wisc.edu/Animations/">SBEL</a></li>
                <li><a href="https://vimeo.com/uwsbel">On Vimeo</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/news/">News</a></li>
        <li><a href="http://projectchrono.org/forum">Forum</a></li>
		<li class="dropdown">
            <a href="http://projectchrono.org/about/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/about/">What is ProjectChrono</a></li>
                <li><a href="http://projectchrono.org/testimonials/">Users</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/status">Status</a></li>            
            <li>
              <form method="get" action="http://projectchrono.org/search" id="search_bar_triggered">
                          <input type="submit" value="Search">
                <input type="text" id="search_bar" name="query" value="" />
              </form> 
            </li>
    </ul>
          <!-- <ul class="nav navbar-nav navbar-right">
      </ul> -->
  </div><!--/.navbar-collapse -->
</div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Project Chrono API/SDK documentation</a></li><li class="navelem"><a class="el" href="manual_root.html">Reference Manual</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Mathematical objects in Chrono </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#linear_algebra">Linear algebra</a></li>
<li class="level1"><a href="#ChFunction_objects">Function objects</a></li>
<li class="level1"><a href="#quadrature">Quadrature</a></li>
</ul>
</div>
<div class="textblock"><p>This documentation component focuses on Chrono mathematical functions and classes. These concepts are quite ubiquitous in the rest of the Chrono API and they are discussed also in the <a class="el" href="classchrono_1_1_ch_matrix.html">chrono::ChMatrix</a> API documentation.</p>
<h1><a class="anchor" id="linear_algebra"></a>
Linear algebra</h1>
<p>Handling vectors and matrices is a recurring theme throughout the Chrono API. ChMatrix is the base class for matrices and vectors and it is used extensively.</p>
<p>Matrices are indexed starting from 0, with (row,column) indexing:</p>
<p class="formulaDsp">
\[ \mathbf{A}=\left[ \begin{array}{cccc} a_{0,0} &amp; a_{0,1} &amp; a_{0,2} &amp; ... \\ a_{1,0} &amp; a_{1,1} &amp; a_{1,2} &amp; ... \\ a_{2,0} &amp; ... &amp; ... &amp; ... \\ a_{n_{rows}-1,0} &amp; ... &amp; ... &amp; a_{n_{rows}-1,n_{cols}-1} \end{array} \right] \]
</p>
<p>There are many specializations of ChMatrix and some of their basic features are outlined next.</p>
<h2>ChMatrixDynamic</h2>
<p>Use ChMatrixDynamic&lt;&gt; to create a matrix with generic size, say 12 rows x 4 columns. Owing to the template argument, one can indicate what type of data the matrix is supposed to store. Note that the default type is 'double'. If performance is not a top issue, this is the type of matrix that is most accurate.</p>
<div class="fragment"><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;double&gt;</a> mh(12,4);</div></div><!-- fragment --><p>See <a class="el" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic</a> for API details.</p>
<h2>ChMatrixNM</h2>
<p>Use ChMatrixNM&lt;&gt; to create matrices that do not need to be resized and whose size is known at compile-time. Columns x rows are passed in template &lt;..&gt; brackets. Although the functionalities are the same of ChMatrixDynamic&lt;&gt;, this type of matrix has better performance. Avoid using it for large M and N sizes since it is allocated on the stack.</p>
<div class="fragment"><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_n_m.html">chrono::ChMatrixNM&lt;double,4,4&gt;</a> mm;</div></div><!-- fragment --><p>See <a class="el" href="classchrono_1_1_ch_matrix_n_m.html">chrono::ChMatrixNM</a> for API details.</p>
<h2>ChMatrix33</h2>
<p>Use ChMatrix33&lt;&gt; to create 3x3 matrices, which are mostly used for coordinate transformations. It inherits the same high-performance features of ChMatrixNM&lt;&gt; and offers additional dedicated functions for coordinate and rotation operations.</p>
<div class="fragment"><div class="line"><a class="code" href="classchrono_1_1_ch_matrix33.html">chrono::ChMatrix33&lt;&gt;</a> ma;</div></div><!-- fragment --><p>See <a class="el" href="classchrono_1_1_ch_matrix33.html">chrono::ChMatrix33</a> for API details.</p>
<h2>ChVectorDynamic</h2>
<p>Use ChVectorDynamic&lt;&gt; to create a one-column matrix with a generic number of rows. </p><div class="ce-info"> This class is different than the ChVector class. The latter is used to represent 3D vectors in space. </div><div class="fragment"><div class="line"><a class="code" href="classchrono_1_1_ch_vector_dynamic.html">chrono::ChVectorDynamic&lt;double&gt;</a> mv(12);</div></div><!-- fragment --><p>See <a class="el" href="classchrono_1_1_ch_vector_dynamic.html">chrono::ChVectorDynamic</a> for API details.</p>
<h2>Basic operations with matrices</h2>
<div class="fragment"><div class="line">        <span class="comment">// Fill a matrix with an element</span></div><div class="line">mm.<a class="code" href="classchrono_1_1_ch_matrix.html#a19cfe072f47c96016a81d5765d0f2a77">FillElem</a>(0.1);</div><div class="line"></div><div class="line">        <span class="comment">// Print a matrix to cout (ex. the console, if open)</span></div><div class="line">mm.<a class="code" href="classchrono_1_1_ch_matrix.html#a42c4d3dcbb46a28e880c64fdbb9c3499">StreamOUT</a>(<a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>());</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// Create a 5x7 random matrix</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> me(5,7);</div><div class="line">me.FillRandom(-1, 2);</div><div class="line"></div><div class="line">        <span class="comment">// Transpose the matrix in place</span></div><div class="line">me.MatrTranspose();</div><div class="line"></div><div class="line">        <span class="comment">// Reset the matrix to zero (and modify size, if necessary).</span></div><div class="line">me.Reset(2,2);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// Create a diagonal matrix</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> md(4,4);</div><div class="line">md.FillDiag(3);</div><div class="line"></div><div class="line">        <span class="comment">// Use the () operator to reference matrix entries</span></div><div class="line">md(0,0) = 10;</div><div class="line">md(1,2) = md(0,0)+md(1,1);</div><div class="line">md.Element(2,2) = 4;    <span class="comment">// The md.Element(.,.) function has the same effect as md(.,.)</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// Copy constructor</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> ma1(md);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// The - unary operator returns a negated matrix</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> ma2(-mm);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// A late copy - matrix will be resized if necessary</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> ma3(8,4);</div><div class="line">ma3.CopyFromMatrix(ma1);</div><div class="line"></div><div class="line">        <span class="comment">// Transposed copy. </span></div><div class="line">        <span class="comment">// This is faster than doing: ma3.CopyFromMatrix(ma2); ma3.MatrTranspose();</span></div><div class="line">ma3.CopyFromMatrixT(ma1);       </div></div><!-- fragment --><p>&lt;&gt; Rely on C++ operator overloading to use the + * - *= += -= operators to perform matrix algebra.</p>
<div class="ce-info"> Note that the + - * operators may introduce overhead because they instantiate temporary matrix objects as intermediate results. Use *= -= += operators whenever possible, or use the specific Add() Multiply() functions for highest computational speed. </div><div class="fragment"><div class="line">                <span class="comment">// Note: size of result is automatically set because of copy constructor</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> result(ma1+ma2); </div><div class="line"></div><div class="line">                <span class="comment">// Using the assignment operator (size of result may be automatically reset)</span></div><div class="line">result = ma1+ma2;       </div><div class="line"></div><div class="line">                <span class="comment">// Another way to do operations - more intricate, but allows higher performances.</span></div><div class="line">                <span class="comment">// Note that you must prepare &#39;result&#39; with already appropriate column/row size.</span></div><div class="line">result.MatrAdd(ma1,ma2);</div><div class="line"></div><div class="line">                <span class="comment">// Use of the += operator typically minimizes the need of intermediate temporary matrices.</span></div><div class="line">result = ma1;</div><div class="line">result += ma2;</div><div class="line"></div><div class="line">                <span class="comment">// Different ways to do subtraction...</span></div><div class="line"></div><div class="line">result = ma1-ma2;       </div><div class="line"></div><div class="line">result.MatrSub(ma1,ma2);</div><div class="line"></div><div class="line">result = ma1;</div><div class="line">result -= ma2;</div><div class="line"></div><div class="line"></div><div class="line">                <span class="comment">// Multiplications between two matrices, different methods...</span></div><div class="line"></div><div class="line">result = ma1*ma2;       </div><div class="line"></div><div class="line">result.MatrMultiply(ma1,ma2);</div><div class="line"></div><div class="line"></div><div class="line">                <span class="comment">// Multiplication between matrix and scalars, different methods...</span></div><div class="line"></div><div class="line">result = ma1*10;</div><div class="line"></div><div class="line">result = ma1;</div><div class="line">result.MatrScale(10);</div><div class="line"><a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; result;</div><div class="line"></div><div class="line">result = ma1;</div><div class="line">result *=10;</div><div class="line"><a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; result;</div><div class="line"></div><div class="line">                <span class="comment">// Dot multiplication</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> mmv1(5,1);</div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> mmv2(5,1);</div><div class="line">mmv1.FillRandom(1,3);</div><div class="line">mmv2.FillRandom(2,4);</div><div class="line"><span class="keywordtype">double</span> mdot = <a class="code" href="classchrono_1_1_ch_matrix.html#a164c76f3adacdfce75f12d33318e1b86">chrono::ChMatrix&lt;&gt;::MatrDot</a>(&amp;mmv1, &amp;mmv2);</div><div class="line"></div><div class="line">                <span class="comment">// Elementwise matrix comparison</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_dynamic.html">chrono::ChMatrixDynamic&lt;&gt;</a> mmv3(mmv2);</div><div class="line"><span class="keywordflow">if</span> (mmv2==mmv3) </div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Matrices are exactly equal \n&quot;</span>;</div><div class="line"></div><div class="line">                <span class="comment">// Tolerance comparison</span></div><div class="line">mmv3.Element(2,0)+=0.001;</div><div class="line"><span class="keywordflow">if</span> (mmv2.Equals(mmv3,0.002)) </div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Matrices are equal within tol 0.002 \n&quot;</span>;</div></div><!-- fragment --><p>&lt;&gt;</p>
<p>The matrices can operate also on 3D vectors \( \mathbf{v}=\{v_x,v_y,v_z\} \), that are defined with the ChVector&lt;&gt; class (the Vector is a shortcut for <a class="el" href="classchrono_1_1_ch_vector.html">ChVector&lt;double&gt;</a> ). Example:</p>
<div class="fragment"><div class="line"><a class="code" href="classchrono_1_1_ch_vector.html">chrono::Vector</a> mvect(1,2,3);    </div><div class="line"><a class="code" href="classchrono_1_1_ch_quaternion.html">chrono::Quaternion</a> mquat(1,2,3,4);</div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix33.html">chrono::ChMatrix33&lt;&gt;</a> mta1;</div><div class="line">mta1.<a class="code" href="classchrono_1_1_ch_matrix.html#aed55971506506c1dc21f822bd451fc72">FillRandom</a>(-1, 2);</div><div class="line"></div><div class="line">                <span class="comment">// Vector transformation, typical product [A]*v</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_vector.html">chrono::Vector</a> vres  = mta1.<a class="code" href="classchrono_1_1_ch_matrix33.html#a8e4c82bf3593277d238ea6cea7b667ff">Matr_x_Vect</a>(mvect);</div><div class="line"></div><div class="line">                <span class="comment">// More compact syntax: operator * between matrix and vector...</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_vector.html">chrono::Vector</a> vres2 = mta1*mvect;</div><div class="line"><span class="keywordflow">if</span> (vres == vres2) </div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;vectors are equal \n&quot;</span>;</div><div class="line"></div><div class="line">                <span class="comment">// .. same, but with a transposed matrix</span></div><div class="line">vres = mta1.<a class="code" href="classchrono_1_1_ch_matrix33.html#ad01a4f98830794c6ce033afa38bba3c4">MatrT_x_Vect</a>(mvect);</div><div class="line"></div><div class="line">                <span class="comment">// Custom multiplication functions for 3x4 matrices and quaternions:</span></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_n_m.html">chrono::ChMatrixNM&lt;double,3,4&gt;</a> mgl;</div><div class="line">mgl.<a class="code" href="classchrono_1_1_ch_matrix.html#aed55971506506c1dc21f822bd451fc72">FillRandom</a>(-1, 2);</div><div class="line">vres = mgl.<a class="code" href="classchrono_1_1_ch_matrix.html#adedf04caa91f428c1e817ad5f73b1726">Matr34_x_Quat</a>(mquat);</div><div class="line"></div><div class="line"><a class="code" href="classchrono_1_1_ch_quaternion.html">chrono::Quaternion</a> qres = mgl.<a class="code" href="classchrono_1_1_ch_matrix.html#a9799a01174de21819bda5618c7bb47b8">Matr34T_x_Vect</a>(mvect);</div><div class="line"></div><div class="line"><a class="code" href="classchrono_1_1_ch_matrix_n_m.html">chrono::ChMatrixNM&lt;double,4,4&gt;</a> mxq;</div><div class="line">mxq.<a class="code" href="classchrono_1_1_ch_matrix.html#aed55971506506c1dc21f822bd451fc72">FillRandom</a>(-1, 2);</div><div class="line">qres = mxq.<a class="code" href="classchrono_1_1_ch_matrix.html#a7661b717172bc320d80b98a1c8c18d26">Matr44_x_Quat</a>(mquat);</div></div><!-- fragment --><h1><a class="anchor" id="ChFunction_objects"></a>
Function objects</h1>
<p>These ChFunction objects are used in many places in Chrono::Engine, and are used to represent y=f(x) functions, for example when introducing prescribed displacements in a linear actuator.</p>
<p>These functions are scalar, </p><p class="formulaDsp">
\[ x \in \mathbb{R} \rightarrow y \in \mathbb{R} \]
</p>
<p> and there are a predefined number of them that are ready to use, such as sine, cosine, constant, etc. If the predefined ones are not enough, the user can implement his custom function by inheriting from the base ChFunction class.</p>
<p>See <a class="el" href="classchrono_1_1_ch_function.html">chrono::ChFunction</a> for API details and a list of subclasses.</p>
<h3>Example 1</h3>
<div class="fragment"><div class="line">ChFunction_Ramp f_ramp;</div><div class="line"></div><div class="line">f_ramp.<a class="code" href="classchrono_1_1_ch_function___ramp.html#a1770f55af709de9923fa9b926669b69b">Set_ang</a>(0.1);    <span class="comment">// set angular coefficient;</span></div><div class="line">f_ramp.Set_y0(0.4);             <span class="comment">// set y value for x=0;</span></div><div class="line"></div><div class="line"> <span class="comment">// Evaluate y=f(x) function at a given x value, using Get_y() :</span></div><div class="line"><span class="keywordtype">double</span> y        = f_ramp.Get_y(10);</div><div class="line"> <span class="comment">// Evaluate derivative df(x)/dx at a given x value, using Get_y_dx() :</span></div><div class="line"><span class="keywordtype">double</span> ydx      = f_ramp.Get_y_dx(10);</div><div class="line"></div><div class="line"><a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;   ChFunction_Ramp at x=0: y=&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;  dy/dx=&quot;</span> &lt;&lt; ydx &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div></div><!-- fragment --><h3>Example 2</h3>
<p>Save values of a sine ChFunction into a file.</p>
<div class="fragment"><div class="line">ChFunction_Sine f_sine;</div><div class="line"></div><div class="line">f_sine.Set_amp(2);              <span class="comment">// set amplitude;</span></div><div class="line">f_sine.Set_freq(1.5);   <span class="comment">// set frequency;</span></div><div class="line"></div><div class="line">ChStreamOutAsciiFile file_f_sine (<span class="stringliteral">&quot;f_sine_out.dat&quot;</span>);</div><div class="line"></div><div class="line"> <span class="comment">// Evaluate y=f(x) function along 100 x points, and its derivatives, </span></div><div class="line"> <span class="comment">// and save to file (later it can be loaded, for example, in Matlab)</span></div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;100; i++)</div><div class="line">{</div><div class="line">        <span class="keywordtype">double</span> x = (double)i/50.0;</div><div class="line">        <span class="keywordtype">double</span> y = f_sine.Get_y(x);</div><div class="line">        <span class="keywordtype">double</span> ydx = f_sine.Get_y_dx(x);</div><div class="line">        <span class="keywordtype">double</span> ydxdx = f_sine.Get_y_dxdx(x);</div><div class="line">        file_f_sine &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ydx &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ydxdx &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}       </div></div><!-- fragment --><h3>Example 3</h3>
<p>Define a custom function.</p>
<p>The following class will be used as an example of how you can create custom functions based on the ChFunction interface.</p>
<p>There is at least one mandatory member function to implement: <b>Get_y()</b>.</p>
<p>Note that the base class implements a default computation of derivatives Get_ydx() and Get_ydxdx() by using a numerical differentiation, however if you know the analytical expression of derivatives, you can override the base Get_ydx() and Get_ydxdx() too, for higher precision.</p>
<div class="fragment"><div class="line"><span class="comment">// First, define a custom class inherited from ChFunction</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>ChFunction_MyTest : <span class="keyword">public</span> ChFunction</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">        ChFunction* new_Duplicate() {<span class="keywordflow">return</span> <span class="keyword">new</span> ChFunction_MyTest;} </div><div class="line">        <span class="keywordtype">double</span> Get_y(<span class="keywordtype">double</span> x) {<span class="keywordflow">return</span> cos(x);} <span class="comment">// just for test: simple cosine</span></div><div class="line">};</div><div class="line"></div><div class="line">ChFunction_MyTest f_test;</div><div class="line"></div><div class="line">ChStreamOutAsciiFile file_f_test (<span class="stringliteral">&quot;f_test_out.dat&quot;</span>);</div><div class="line"></div><div class="line"> <span class="comment">// Evaluate y=f(x) function along 100 x points, and its derivatives, </span></div><div class="line"> <span class="comment">// and save to file (later it can be loaded, for example, in Matlab)</span></div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;100; i++)</div><div class="line">{</div><div class="line">        <span class="keywordtype">double</span> x = (double)i/50.0;</div><div class="line">        <span class="keywordtype">double</span> y = f_test.Get_y(x);</div><div class="line">        <span class="keywordtype">double</span> ydx = f_test.Get_y_dx(x);</div><div class="line">        <span class="keywordtype">double</span> ydxdx = f_test.Get_y_dxdx(x);</div><div class="line">        file_f_test &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ydx &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ydxdx &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="quadrature"></a>
Quadrature</h1>
<p>Quadrature is an operation that computes integrals as when computing areas and volumes.</p>
<p>The following code shows how to use the Gauss-Legendre quadrature to compute the integral of a function \( \mathbb{R} \mapsto \mathbb{R} \) over a 1D interval, or \( f: \mathbb{R}^2 \mapsto \mathbb{R}\) over a 2D interval or \( f: \mathbb{R}^3 \mapsto \mathbb{R}\) over a 3D interval:</p>
<p class="formulaDsp">
\[ F_{1D}=\int^a_b f(x) dx \]
</p>
<p class="formulaDsp">
\[ F_{2D}=\int^{a_y}_{b_y}\int^{a_x}_{b_x} f(x,y) dx dy \]
</p>
<p class="formulaDsp">
\[ F_{3D}=\int^{a_z}_{b_z}\int^{a_y}_{b_y}\int^{a_x}_{b_x} f(x,y,z) dx dy dz \]
</p>
<p>If the function is polynomial of degree N and the quadrature is of order N, the result is exact, otherwise it is approximate (using large N improves quality but remember that this type of integration is often used where N in the range 1..10 suffices, otherwise other integration methods might be better).</p>
<p>For N less than 10, the quadrature uses precomputed coefficients for maximum performance.</p>
<div class="fragment"><div class="line">                                        <span class="comment">// Define a y=f(x) function by inheriting ChIntegrable1D:</span></div><div class="line"><span class="keyword">class </span>MySine1d : <span class="keyword">public</span> ChIntegrable1D&lt;double&gt;</div><div class="line">{</div><div class="line"><span class="keyword">public</span>: </div><div class="line">        <span class="keywordtype">void</span> Evaluate (<span class="keywordtype">double</span>&amp; result, <span class="keyword">const</span> <span class="keywordtype">double</span> x)  {</div><div class="line">                result = sin(x);</div><div class="line">        }</div><div class="line">};</div><div class="line">                                        <span class="comment">// Create an object from the function class</span></div><div class="line">MySine1d mfx;</div><div class="line">                                        <span class="comment">// Invoke 6th order Gauss-Legendre quadrature on 0..PI interval:</span></div><div class="line"><span class="keywordtype">double</span> qresult; </div><div class="line">ChQuadrature::Integrate1D&lt;double&gt;(qresult, mfx,  0, CH_C_PI,  6);</div><div class="line"></div><div class="line"><a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>()&lt;&lt; <span class="stringliteral">&quot;Quadrature 1d result:&quot;</span> &lt;&lt; qresult &lt;&lt; <span class="stringliteral">&quot; (analytic solution: 2.0) \n&quot;</span>;</div><div class="line"></div><div class="line"></div><div class="line">                                        <span class="comment">// Other quadrature tests, this time in 2D</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MySine2d : <span class="keyword">public</span> ChIntegrable2D&lt;double&gt;</div><div class="line">{</div><div class="line"><span class="keyword">public</span>: </div><div class="line">        <span class="keywordtype">void</span> Evaluate (<span class="keywordtype">double</span>&amp; result, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y) { result = sin(x); }</div><div class="line">};</div><div class="line"></div><div class="line">MySine2d mfx2d;</div><div class="line">ChQuadrature::Integrate2D&lt;double&gt;(qresult, mfx2d, 0, CH_C_PI, -1,1, 6);</div><div class="line"><a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>()&lt;&lt; <span class="stringliteral">&quot;Quadrature 2d result:&quot;</span> &lt;&lt; qresult &lt;&lt; <span class="stringliteral">&quot; (analytic solution: 4.0) \n&quot;</span>;</div></div><!-- fragment --><p>Note that thanks to templating, one can also integrate m-dimensional (vectorial, tensorial) functions \( \mathbf{f}: \mathbb{R}^n \mapsto \mathbb{R}^m \) , for example:</p>
<p class="formulaDsp">
\[ \mathbf{F}=\int^{a_y}_{b_y}\int^{a_x}_{b_x} \mathbf{f}(x,y) dx dy \quad \mathbf{F} \in \mathbb{R}^2 \]
</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MySine2dM : <span class="keyword">public</span> ChIntegrable2D&lt; ChMatrixNM&lt;double,2,1&gt; &gt;</div><div class="line">{</div><div class="line"><span class="keyword">public</span>: </div><div class="line">        <span class="keywordtype">void</span> Evaluate (ChMatrixNM&lt;double,2,1&gt;&amp; result, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y) </div><div class="line">        { </div><div class="line">                result(0) = x*y;</div><div class="line">                result(1) = 0.5*y*y;</div><div class="line">        }</div><div class="line">};</div><div class="line"></div><div class="line">MySine2dM mfx2dM;</div><div class="line">ChMatrixNM&lt;double,2,1&gt; resultM;</div><div class="line">ChQuadrature::Integrate2D&lt; ChMatrixNM&lt;double,2,1&gt; &gt;(resultM, mfx2dM, 0, 1, 0,3, 6);</div><div class="line"><a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>()&lt;&lt; <span class="stringliteral">&quot;Quadrature 2d matrix result:&quot;</span> &lt;&lt; resultM &lt;&lt; <span class="stringliteral">&quot; (analytic solution: 2.25, 4.5) \n&quot;</span>;</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 1 2016 15:43:10 for Project Chrono by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11 . <a href="mailto:info@projectchrono.org">Contact us</a> for issues related to this page. 
</small></address>
</body>
</html>
