<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>Project Chrono: Tracked vehicle example (demo_tracks.cpp)</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://projectchrono.org">
            <span class="logo first">PROJECT</span><span class="logo second">CHRONO</span>
        </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://projectchrono.org/download">Download</a></li>
        <li class="dropdown">
            <a href="http://api.chrono.projectchrono.org" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://api.chrono.projectchrono.org/faq_root.html">FAQ</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_table_of_content_install.html">Install Guide</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_root.html">Examples/Tutorials</a></li>
                <li><a href="http://api.chrono.projectchrono.org/model_root.html">Model Library</a></li>
                <li><a href="http://api.chrono.projectchrono.org/validation_studies_root.html">Validation Studies</a></li>
                <li><a href="http://api.chrono.projectchrono.org/whitepaper_root.html">White Papers</a></li>
                <li><a href="http://projectchrono.org/docpdf">PDF Version</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="http://projectchrono.org/gallery/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" style="dropdown:hover" aria-haspopup="true" aria-expanded="false">Movies <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/gallery/">Gallery</a></li>
                <li><a href="http://sbel.wisc.edu/Animations/">SBEL</a></li>
                <li><a href="https://vimeo.com/uwsbel">On Vimeo</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/news/">News</a></li>
        <li><a href="http://projectchrono.org/forum">Forum</a></li>
		<li class="dropdown">
            <a href="http://projectchrono.org/about/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/about/">What is ProjectChrono</a></li>
                <li><a href="http://projectchrono.org/testimonials/">Users</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/status">Status</a></li>            
            <li>
              <form method="get" action="http://projectchrono.org/search" id="search_bar_triggered">
                          <input type="submit" value="Search">
                <input type="text" id="search_bar" name="query" value="" />
              </form> 
            </li>
    </ul>
          <!-- <ul class="nav navbar-nav navbar-right">
      </ul> -->
  </div><!--/.navbar-collapse -->
</div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Project Chrono API/SDK documentation</a></li><li class="navelem"><a class="el" href="manual_root.html">Reference Manual</a></li><li class="navelem"><a class="el" href="tutorial_root.html">Tutorials</a></li><li class="navelem"><a class="el" href="tutorial_table_of_content_chrono_irrlicht.html">Chrono IRRLICHT module tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tracked vehicle example (demo_tracks.cpp) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Simulate a simplified vehicle with tracks, that interact with obstacles, and that can be driven by the user.</p>
<p>This tutorial shows how to:</p>
<ul>
<li>create different 'families' of collision objects (ex. to avoid that unnecessry contacts are created between adjacent track shoes).</li>
<li>make custom compound collision shapes.</li>
<li>load a non-concave collision mesh that is decomposed in convex parts</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// PROJECT CHRONO - http://projectchrono.org</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Copyright (c) 2010-2012 Alessandro Tasora</span></div><div class="line"><span class="comment">// All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div><div class="line"><span class="comment">// found in the LICENSE file at the top level of the distribution</span></div><div class="line"><span class="comment">// and at http://projectchrono.org/license-chrono.txt.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   Demo code about</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     - modeling tracks with articulated shoes (as an example</span></div><div class="line"><span class="comment">//       of complex model with collisions and constraints)</span></div><div class="line"><span class="comment">//     - using different meshes for collision and visualization</span></div><div class="line"><span class="comment">//     - using clones of collision shapes</span></div><div class="line"><span class="comment">//     - using SetFamilyMaskNoCollisionWithFamily, SetFamily etc.</span></div><div class="line"><span class="comment">//       to avoid collisions between different families of bodies.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       CHRONO</span></div><div class="line"><span class="comment">//   ------</span></div><div class="line"><span class="comment">//   Multibody dinamics engine</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment">//             http://www.projectchrono.org</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChSystem.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChBodyEasy.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChBodySceneNode.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChBodySceneNodeTools.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChIrrApp.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/core/ChRealtimeStep.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/geometry/ChTriangleMeshSoup.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;irrlicht.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Use the namespaces of Chrono</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono.html">chrono</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono_1_1geometry.html">chrono::geometry</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono_1_1irrlicht.html">chrono::irrlicht</a>;</div><div class="line"></div><div class="line"><span class="comment">// Use the main namespaces of Irrlicht</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr.html">irr</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1core.html">irr::core</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1scene.html">irr::scene</a>;</div><div class="line"><span class="keyword">using namespace </span>irr::video;</div><div class="line"><span class="keyword">using namespace </span>irr::io;</div><div class="line"><span class="keyword">using namespace </span>irr::gui;</div><div class="line"></div><div class="line"><span class="comment">// First of all, define a class for the &#39;tank&#39; (that is, a set of</span></div><div class="line"><span class="comment">// bodies and links which are grouped within this class; so it is</span></div><div class="line"><span class="comment">// easier to manage data structures in this example).</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MySimpleTank {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    <span class="comment">// THE DATA</span></div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> throttleL;        <span class="comment">// actual value 0...1 of gas throttle (left).</span></div><div class="line">    <span class="keywordtype">double</span> throttleR;        <span class="comment">// actual value 0...1 of gas throttle (right).</span></div><div class="line">    <span class="keywordtype">double</span> max_motor_speed;  <span class="comment">// the max rotation speed of the motor [rads/s]</span></div><div class="line"></div><div class="line">    <span class="comment">// The parts making the tank, as 3d Irrlicht scene nodes, each containing</span></div><div class="line">    <span class="comment">// the ChBody object</span></div><div class="line">    <span class="comment">// .. truss:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; truss;</div><div class="line">    <span class="comment">// .. right front suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelRF;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteRF;</div><div class="line">    <span class="comment">// .. left front suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelLF;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteLF;</div><div class="line">    <span class="comment">// .. right back suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelRB;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_revoluteRB;</div><div class="line">    <span class="comment">// .. left back suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelLB;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_revoluteLB;</div><div class="line"></div><div class="line">    <span class="comment">// THE FUNCTIONS</span></div><div class="line"></div><div class="line">    <span class="comment">// Build and initialize the tank, creating all bodies corresponding to</span></div><div class="line">    <span class="comment">// the various parts and adding them to the physical system - also creating</span></div><div class="line">    <span class="comment">// and adding constraints to the system.</span></div><div class="line">    MySimpleTank(<a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>&amp; my_system,           </div><div class="line">                 ISceneManager* msceneManager,  </div><div class="line">                 IVideoDriver* mdriver          </div><div class="line">                 ) {</div><div class="line">        throttleL = throttleR = 0;  <span class="comment">// initially, gas throttle is 0.</span></div><div class="line">        max_motor_speed = 10;</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span> my = 0.5;  <span class="comment">// left back hub pos</span></div><div class="line">        <span class="keywordtype">double</span> mx = 0;</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span> shoelength = 0.2;</div><div class="line">        <span class="keywordtype">double</span> shoethickness = 0.06;</div><div class="line">        <span class="keywordtype">double</span> shoewidth = 0.3;</div><div class="line">        <span class="keywordtype">double</span> shoemass = 2;</div><div class="line">        <span class="keywordtype">double</span> radiustrack = 0.31;</div><div class="line">        <span class="keywordtype">double</span> wheeldiameter = 0.280 * 2;</div><div class="line">        <span class="keywordtype">int</span> nwrap = 6;</div><div class="line">        <span class="keywordtype">int</span> ntiles = 7;</div><div class="line">        <span class="keywordtype">double</span> rlwidth = 1.20;</div><div class="line">        <span class="keywordtype">double</span> passo = (ntiles + 1) * shoelength;</div><div class="line"></div><div class="line">        ChVector&lt;&gt; cyl_displA(0, 0.075 + 0.02, 0);</div><div class="line">        ChVector&lt;&gt; cyl_displB(0, -0.075 - 0.02, 0);</div><div class="line">        <span class="keywordtype">double</span> cyl_hthickness = 0.045;</div><div class="line"></div><div class="line">        <span class="comment">// --- The tank body ---</span></div><div class="line"></div><div class="line">        truss = std::make_shared&lt;ChBodyEasyMesh&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;bulldozerB10.obj&quot;</span>).c_str(), 1000, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(truss);</div><div class="line">        truss-&gt;SetPos(ChVector&lt;&gt;(mx + passo / 2, my + radiustrack, rlwidth / 2));</div><div class="line">        truss-&gt;SetMass(350);</div><div class="line">        truss-&gt;SetInertiaXX(ChVector&lt;&gt;(13.8, 13.5, 10));</div><div class="line"></div><div class="line">        <span class="comment">// --- Right Front suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// Load a triangle mesh for wheel visualization</span></div><div class="line">        IAnimatedMesh* irmesh_wheel_view = msceneManager-&gt;getMesh(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel_view.obj&quot;</span>).c_str());</div><div class="line"></div><div class="line">        <span class="comment">// ..the tank right-front wheel</span></div><div class="line">        wheelRF = std::make_shared&lt;ChBodyEasyMesh&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel_view.obj&quot;</span>).c_str(), 1000, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelRF);</div><div class="line">        wheelRF-&gt;SetPos(ChVector&lt;&gt;(mx + passo, my + radiustrack, 0));</div><div class="line">        wheelRF-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_X));</div><div class="line">        wheelRF-&gt;SetMass(9.0);</div><div class="line">        wheelRF-&gt;SetInertiaXX(ChVector&lt;&gt;(1.2, 1.2, 1.2));</div><div class="line">        wheelRF-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line"></div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displA);</div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displB);</div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;BuildModel();  </div><div class="line">        wheelRF-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"> </div><div class="line">        <span class="keyword">auto</span> color_wheel = std::make_shared&lt;ChColorAsset&gt;();</div><div class="line">        color_wheel-&gt;SetColor(<a class="code" href="classchrono_1_1_ch_color.html">ChColor</a>(0.2f,0.2f,0.2f));</div><div class="line">        wheelRF-&gt;AddAsset(color_wheel);</div><div class="line">        </div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the truss</span></div><div class="line">        link_revoluteRF = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// right, front, upper, 1</span></div><div class="line">        link_revoluteRF-&gt;Initialize(wheelRF, truss,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(mx + passo, my + radiustrack, 0), QUNIT));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteRF);</div><div class="line"></div><div class="line">        <span class="comment">// --- Left Front suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the tank left-front wheel</span></div><div class="line"></div><div class="line">        wheelLF = std::make_shared&lt;ChBodyEasyMesh&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel_view.obj&quot;</span>).c_str(), 1000, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelLF);</div><div class="line">        wheelLF-&gt;SetPos(ChVector&lt;&gt;(mx + passo, my + radiustrack, rlwidth));</div><div class="line">        wheelLF-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_X));</div><div class="line">        wheelLF-&gt;SetMass(9.0);</div><div class="line">        wheelLF-&gt;SetInertiaXX(ChVector&lt;&gt;(1.2, 1.2, 1.2));</div><div class="line">        wheelLF-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelLF-&gt;AddAsset(color_wheel);</div><div class="line"></div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displA);</div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displB);</div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        wheelLF-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the truss</span></div><div class="line">        link_revoluteLF = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// left, front, upper, 1</span></div><div class="line">        link_revoluteLF-&gt;Initialize(wheelLF, truss,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(mx + passo, my + radiustrack, rlwidth), QUNIT));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteLF);</div><div class="line"></div><div class="line">        <span class="comment">// --- Right Back suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the tank right-back wheel</span></div><div class="line"></div><div class="line">        wheelRB = std::make_shared&lt;ChBodyEasyMesh&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel_view.obj&quot;</span>).c_str(), 1000, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelRB);</div><div class="line">        wheelRB-&gt;SetPos(ChVector&lt;&gt;(mx, my + radiustrack, 0));</div><div class="line">        wheelRB-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_X));</div><div class="line">        wheelRB-&gt;SetMass(9.0);</div><div class="line">        wheelRB-&gt;SetInertiaXX(ChVector&lt;&gt;(1.2, 1.2, 1.2));</div><div class="line">        wheelRB-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelRB-&gt;AddAsset(color_wheel);</div><div class="line"></div><div class="line">        wheelRB-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelRB-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displA);</div><div class="line">        wheelRB-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displB);</div><div class="line">        wheelRB-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        wheelRB-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the motor joint between the wheel and the truss (simplified motor model: just impose speed..)</span></div><div class="line">        link_revoluteRB = std::make_shared&lt;ChLinkEngine&gt;();  <span class="comment">// right, back, upper, 1</span></div><div class="line">        link_revoluteRB-&gt;Initialize(wheelRB, truss,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(mx, my + radiustrack, 0), QUNIT));</div><div class="line">        link_revoluteRB-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_SPEED);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteRB);</div><div class="line"></div><div class="line">        <span class="comment">// --- Left Back suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the tank left-back wheel</span></div><div class="line"></div><div class="line">        wheelLB = std::make_shared&lt;ChBodyEasyMesh&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel_view.obj&quot;</span>).c_str(), 1000, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelLB);</div><div class="line">        wheelLB-&gt;SetPos(ChVector&lt;&gt;(mx, my + radiustrack, rlwidth));</div><div class="line">        wheelLB-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_X));</div><div class="line">        wheelLB-&gt;SetMass(9.0);</div><div class="line">        wheelLB-&gt;SetInertiaXX(ChVector&lt;&gt;(1.2, 1.2, 1.2));</div><div class="line">        wheelLB-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelLB-&gt;AddAsset(color_wheel);</div><div class="line"></div><div class="line">        wheelLB-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelLB-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displA);</div><div class="line">        wheelLB-&gt;GetCollisionModel()-&gt;AddCylinder(wheeldiameter / 2, wheeldiameter / 2, cyl_hthickness, cyl_displB);</div><div class="line">        wheelLB-&gt;GetCollisionModel()-&gt;BuildModel(); </div><div class="line">        wheelLB-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// .. create the motor joint between the wheel and the truss (simplified motor model: just impose speed..)</span></div><div class="line">        link_revoluteLB = std::make_shared&lt;ChLinkEngine&gt;();  <span class="comment">// left, back, upper, 1</span></div><div class="line">        link_revoluteLB-&gt;Initialize(wheelLB, truss,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(mx, my + radiustrack, rlwidth), QUNIT));</div><div class="line">        link_revoluteLB-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_SPEED);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteLB);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//--- TRACKS ---</span></div><div class="line"></div><div class="line">        <span class="comment">// Load a triangle mesh for collision</span></div><div class="line">        IAnimatedMesh* irmesh_shoe_collision = msceneManager-&gt;getMesh(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;shoe_collision.obj&quot;</span>).c_str());</div><div class="line">        <a class="code" href="classchrono_1_1geometry_1_1_ch_triangle_mesh_soup.html">ChTriangleMeshSoup</a> temp_trianglemesh;</div><div class="line">        <a class="code" href="group__irrlicht__module.html#gaeac7cdee7f17c40dc3650aca58df3003">fillChTrimeshFromIrlichtMesh</a>(&amp;temp_trianglemesh, irmesh_shoe_collision-&gt;getMesh(0));</div><div class="line"></div><div class="line">        ChVector&lt;&gt; mesh_displacement(shoelength * 0.5, 0, 0);  <span class="comment">// as mesh origin is not in body center of mass</span></div><div class="line">        ChVector&lt;&gt; joint_displacement(-shoelength * 0.5, 0, 0);  <span class="comment">// pos. of shoe-shoe constraint, relative to COG.</span></div><div class="line">        ChVector&lt;&gt; pin_displacement = mesh_displacement + ChVector&lt;&gt;(0, 0.05, 0);</div><div class="line"></div><div class="line">        <a class="code" href="classchrono_1_1_ch_vector.html">chrono::ChVector&lt;&gt;</a> position;</div><div class="line">        <a class="code" href="classchrono_1_1_ch_quaternion.html">chrono::ChQuaternion&lt;&gt;</a> rotation;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> side = 0; side &lt; 2; side++) {</div><div class="line">            mx = 0;</div><div class="line">            mx += shoelength;</div><div class="line"></div><div class="line">            <span class="keywordtype">double</span> mz = 0;</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (side == 0)</div><div class="line">                mz = 0;</div><div class="line">            <span class="keywordflow">else</span></div><div class="line">                mz = rlwidth;</div><div class="line"></div><div class="line">            position.<a class="code" href="classchrono_1_1_ch_quaternion.html#aba5098038dd463ba2e34012735bd1c2e">Set</a>(mx, my, mz);</div><div class="line">            rotation = QUNIT;</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">// Create sample body (with empty collision shape; later create the collision model by adding the</span></div><div class="line">            <span class="comment">// coll.shapes)</span></div><div class="line">            <span class="keyword">auto</span> firstBodyShoe = std::make_shared&lt;ChBody&gt;();</div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(firstBodyShoe);</div><div class="line">            firstBodyShoe-&gt;SetMass(shoemass);</div><div class="line">            firstBodyShoe-&gt;SetPos(position);</div><div class="line">            firstBodyShoe-&gt;SetRot(rotation);</div><div class="line">            firstBodyShoe-&gt;SetInertiaXX(ChVector&lt;&gt;(0.1, 0.1, 0.1));</div><div class="line"></div><div class="line">            <span class="comment">// Visualization:</span></div><div class="line">            <span class="keyword">auto</span> shoe_mesh = std::make_shared&lt;ChTriangleMeshShape&gt;();</div><div class="line">            firstBodyShoe-&gt;AddAsset(shoe_mesh);</div><div class="line">            shoe_mesh-&gt;GetMesh().LoadWavefrontMesh(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;shoe_view.obj&quot;</span>).c_str());</div><div class="line">            shoe_mesh-&gt;GetMesh().Transform(-mesh_displacement, <a class="code" href="classchrono_1_1_ch_matrix33.html">ChMatrix33&lt;&gt;</a>(1));</div><div class="line">            shoe_mesh-&gt;SetVisible(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">// Mesh for collision - NOTE: DO NOT USE THIS - TEST: USE OLD temp_trianglemesh AS IT TRIGGERS FASTER CONVEXDECOMPOSITION</span></div><div class="line">            <span class="keyword">auto</span> shoe_coll_mesh = std::make_shared&lt;ChTriangleMeshShape&gt;();</div><div class="line">            firstBodyShoe-&gt;AddAsset(shoe_coll_mesh);</div><div class="line">            shoe_coll_mesh-&gt;GetMesh().LoadWavefrontMesh(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;shoe_collision.obj&quot;</span>).c_str());</div><div class="line">            shoe_coll_mesh-&gt;GetMesh().Transform(-mesh_displacement, <a class="code" href="classchrono_1_1_ch_matrix33.html">ChMatrix33&lt;&gt;</a>(1));</div><div class="line">            shoe_coll_mesh-&gt;SetVisible(<span class="keyword">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">// Collision:</span></div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;SetSafeMargin(0.004);  <span class="comment">// inward safe margin</span></div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;SetEnvelope(0.010);  <span class="comment">// distance of the outward &quot;collision envelope&quot;</span></div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;AddTriangleMesh(temp_trianglemesh, <span class="keyword">false</span>, <span class="keyword">false</span>, mesh_displacement, <a class="code" href="classchrono_1_1_ch_matrix33.html">ChMatrix33&lt;&gt;</a>(1), 0.005);  </div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;BuildModel();  <span class="comment">// Creates the collision model</span></div><div class="line">            firstBodyShoe-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">// Avoid creation of contacts with neighbouring shoes, using</span></div><div class="line">            <span class="comment">// a collision family (=3) that does not collide with itself</span></div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;SetFamily(3);</div><div class="line">            firstBodyShoe-&gt;GetCollisionModel()-&gt;SetFamilyMaskNoCollisionWithFamily(3);</div><div class="line"></div><div class="line">            </div><div class="line">            </div><div class="line"></div><div class="line">            std::shared_ptr&lt;ChBody&gt; previous_rigidBodyShoe;</div><div class="line">            previous_rigidBodyShoe = firstBodyShoe;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nshoe = 1; nshoe &lt; ntiles; nshoe++) {</div><div class="line">                mx += shoelength;</div><div class="line">                position.Set(mx, my, mz);</div><div class="line"></div><div class="line">                <span class="keyword">auto</span> rigidBodyShoe =</div><div class="line">                    MakeShoe(previous_rigidBodyShoe,firstBodyShoe, position, rotation, my_system, joint_displacement);</div><div class="line"></div><div class="line">                previous_rigidBodyShoe = rigidBodyShoe;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nshoe = 0; nshoe &lt; nwrap; nshoe++) {</div><div class="line">                <span class="keywordtype">double</span> alpha = (CH_C_PI / ((double)(nwrap - 1.0))) * ((double)nshoe);</div><div class="line"></div><div class="line">                <span class="keywordtype">double</span> lx = mx + shoelength + radiustrack * sin(alpha);</div><div class="line">                <span class="keywordtype">double</span> ly = my + radiustrack - radiustrack * cos(alpha);</div><div class="line">                position.Set(lx, ly, mz);</div><div class="line">                rotation = chrono::Q_from_AngAxis(alpha, ChVector&lt;&gt;(0, 0, 1));</div><div class="line">                <span class="keyword">auto</span> rigidBodyShoe =</div><div class="line">                    MakeShoe(previous_rigidBodyShoe, firstBodyShoe, position, rotation, my_system, joint_displacement);</div><div class="line"></div><div class="line">                previous_rigidBodyShoe = rigidBodyShoe;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nshoe = (ntiles - 1); nshoe &gt;= 0; nshoe--) {</div><div class="line">                position.Set(mx, my + 2 * radiustrack, mz);</div><div class="line"></div><div class="line">                <span class="keyword">auto</span> rigidBodyShoe =</div><div class="line">                    MakeShoe(previous_rigidBodyShoe, firstBodyShoe, position, rotation, my_system, joint_displacement);</div><div class="line"></div><div class="line">                previous_rigidBodyShoe = rigidBodyShoe;</div><div class="line"></div><div class="line">                mx -= shoelength;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nshoe = 0; nshoe &lt; nwrap; nshoe++) {</div><div class="line">                <span class="keywordtype">double</span> alpha = CH_C_PI + (CH_C_PI / ((double)(nwrap - 1.0))) * ((double)nshoe);</div><div class="line"></div><div class="line">                <span class="keywordtype">double</span> lx = mx + 0 + radiustrack * sin(alpha);</div><div class="line">                <span class="keywordtype">double</span> ly = my + radiustrack - radiustrack * cos(alpha);</div><div class="line">                position.Set(lx, ly, mz);</div><div class="line">                rotation = chrono::Q_from_AngAxis(alpha, ChVector&lt;&gt;(0, 0, 1));</div><div class="line">                <span class="keyword">auto</span> rigidBodyShoe =</div><div class="line">                    MakeShoe(previous_rigidBodyShoe, firstBodyShoe, position, rotation, my_system, joint_displacement);</div><div class="line"></div><div class="line">                previous_rigidBodyShoe = rigidBodyShoe;</div><div class="line">            }</div><div class="line">            <span class="comment">// close track</span></div><div class="line">            ChVector&lt;&gt; linkpos = firstBodyShoe-&gt;Point_Body2World(joint_displacement);</div><div class="line">            <span class="keyword">auto</span> link_revolute_shoeshoe = std::make_shared&lt;ChLinkLockRevolute&gt;();</div><div class="line">            link_revolute_shoeshoe-&gt;Initialize(firstBodyShoe, previous_rigidBodyShoe,</div><div class="line">                                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(linkpos, QUNIT));</div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revolute_shoeshoe);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Delete the tank object, deleting also all bodies corresponding to</span></div><div class="line">    <span class="comment">// the various parts and removing them from the physical system.  Also</span></div><div class="line">    <span class="comment">// removes constraints from the system.</span></div><div class="line">    ~MySimpleTank() {</div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>* mysystem = truss-&gt;<a class="code" href="classchrono_1_1_ch_physics_item.html#a87da1034f53c53e8971259dd269bdfe0">GetSystem</a>();  <span class="comment">// trick to get the system here</span></div><div class="line"></div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_revoluteRF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_revoluteLF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_revoluteRB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_revoluteLB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(truss);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelRF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelLF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelRB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelLB);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Utility function to create quickly a track shoe connected to the previous one</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt;</div><div class="line">    MakeShoe(std::shared_ptr&lt;ChBody&gt; previous_shoe,  <span class="comment">// will be linked with this one with revolute joint</span></div><div class="line">             std::shared_ptr&lt;ChBody&gt; template_shoe,  <span class="comment">// collision geometry will be shared with this body, to save memory&amp;cpu time.</span></div><div class="line">             ChVector&lt;&gt; position,                    <span class="comment">// position</span></div><div class="line">             <a class="code" href="classchrono_1_1_ch_quaternion.html">ChQuaternion&lt;&gt;</a> rotation,                <span class="comment">// orientation</span></div><div class="line">             <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>&amp; my_system,                    <span class="comment">// the physical system</span></div><div class="line">             <a class="code" href="classchrono_1_1_ch_vector.html">chrono::ChVector&lt;&gt;</a> joint_displacement   <span class="comment">// position of shoe-shoe constraint, relative to COG.</span></div><div class="line">             ) {</div><div class="line">        <span class="keyword">auto</span> rigidBodyShoe = std::shared_ptr&lt;ChBody&gt;(template_shoe.get()-&gt;Clone());</div><div class="line">        rigidBodyShoe-&gt;SetPos(position);</div><div class="line">        rigidBodyShoe-&gt;SetRot(rotation);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(rigidBodyShoe);</div><div class="line"></div><div class="line">        rigidBodyShoe-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        rigidBodyShoe-&gt;GetCollisionModel()-&gt;AddCopyOfAnotherModel(template_shoe-&gt;GetCollisionModel());</div><div class="line">        rigidBodyShoe-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        rigidBodyShoe-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <span class="comment">// Other settings are already copied from template_shoe, except for family and mask.</span></div><div class="line">        <span class="comment">// Avoid creation of contacts with neighbouring shoes:</span></div><div class="line">        rigidBodyShoe-&gt;GetCollisionModel()-&gt;SetFamily(3);</div><div class="line">        rigidBodyShoe-&gt;GetCollisionModel()-&gt;SetFamilyMaskNoCollisionWithFamily(3);</div><div class="line"></div><div class="line">        <span class="comment">// Create revolute constraint</span></div><div class="line">        <span class="keywordflow">if</span> (previous_shoe) {</div><div class="line">            ChVector&lt;&gt; linkpos = rigidBodyShoe-&gt;Point_Body2World(joint_displacement);</div><div class="line">            <span class="keyword">auto</span> link_revolute_shoeshoe = std::make_shared&lt;ChLinkLockRevolute&gt;();</div><div class="line">            link_revolute_shoeshoe-&gt;Initialize(rigidBodyShoe, previous_shoe,</div><div class="line">                                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(linkpos, QUNIT));</div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revolute_shoeshoe);</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> rigidBodyShoe;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// Define a MyEventReceiver class which will be used to manage input</span></div><div class="line"><span class="comment">// from the GUI graphical user interface (the interface will</span></div><div class="line"><span class="comment">// be created with the basic -yet flexible- platform</span></div><div class="line"><span class="comment">// independent toolset of Irrlicht).</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MyEventReceiver : <span class="keyword">public</span> IEventReceiver {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    MyEventReceiver(<a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app_interface.html">ChIrrAppInterface</a>* myapp, MySimpleTank* atank) {</div><div class="line">        <span class="comment">// store pointer application</span></div><div class="line">        application = myapp;</div><div class="line">        <span class="comment">// store pointer to other stuff</span></div><div class="line">        mtank = atank;</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI slider to control throttle left via mouse</span></div><div class="line">        scrollbar_throttleL =</div><div class="line">            application-&gt;GetIGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(510, 20, 650, 35), 0, 101);</div><div class="line">        scrollbar_throttleL-&gt;setMax(100);</div><div class="line">        scrollbar_throttleL-&gt;setPos(50);</div><div class="line">        text_throttleL =</div><div class="line">            application-&gt;GetIGUIEnvironment()-&gt;addStaticText(L<span class="stringliteral">&quot;Left throttle &quot;</span>, rect&lt;s32&gt;(650, 20, 750, 35), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI slider to control gas throttle right via mouse</span></div><div class="line">        scrollbar_throttleR =</div><div class="line">            application-&gt;GetIGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(510, 45, 650, 60), 0, 102);</div><div class="line">        scrollbar_throttleR-&gt;setMax(100);</div><div class="line">        scrollbar_throttleR-&gt;setPos(50);</div><div class="line">        text_throttleR =</div><div class="line">            application-&gt;GetIGUIEnvironment()-&gt;addStaticText(L<span class="stringliteral">&quot;Right throttle&quot;</span>, rect&lt;s32&gt;(650, 45, 750, 60), <span class="keyword">false</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">bool</span> OnEvent(<span class="keyword">const</span> SEvent&amp; event) {</div><div class="line">        <span class="comment">// check if user moved the sliders with mouse..</span></div><div class="line">        <span class="keywordflow">if</span> (event.EventType == EET_GUI_EVENT) {</div><div class="line">            s32 <span class="keywordtype">id</span> = <span class="keyword">event</span>.GUIEvent.Caller-&gt;getID();</div><div class="line">            IGUIEnvironment* env = application-&gt;GetIGUIEnvironment();</div><div class="line"></div><div class="line">            <span class="keywordflow">switch</span> (event.GUIEvent.EventType) {</div><div class="line">                <span class="keywordflow">case</span> EGET_SCROLL_BAR_CHANGED:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 101)  <span class="comment">// id of &#39;throttleL&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newthrottle = ((double)(pos)-50) / 50.0;</div><div class="line">                        this-&gt;mtank-&gt;throttleL = newthrottle;</div><div class="line">                        <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(mtank-&gt;link_revoluteLB-&gt;Get_spe_funct()))</div><div class="line">                            mfun-&gt;Set_yconst(newthrottle * 6);</div><div class="line">                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 102)  <span class="comment">// id of &#39;throttleR&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newthrottle = ((double)(pos)-50) / 50.0;</div><div class="line">                        this-&gt;mtank-&gt;throttleR = newthrottle;</div><div class="line">                        <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(mtank-&gt;link_revoluteRB-&gt;Get_spe_funct()))</div><div class="line">                            mfun-&gt;Set_yconst(newthrottle * 6);</div><div class="line">                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app_interface.html">ChIrrAppInterface</a>* application;</div><div class="line">    MySimpleTank* mtank;</div><div class="line"></div><div class="line">    IGUIStaticText* text_throttleL;</div><div class="line">    IGUIScrollBar* scrollbar_throttleL;</div><div class="line">    IGUIStaticText* text_throttleR;</div><div class="line">    IGUIScrollBar* scrollbar_throttleR;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// This is the program which is executed</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">    <span class="comment">// 1- Create a ChronoENGINE physical system: all bodies and constraints</span></div><div class="line">    <span class="comment">//    will be handled by this ChSystem object.</span></div><div class="line">    <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">    <span class="comment">// Create the Irrlicht visualization (open the Irrlicht device,</span></div><div class="line">    <span class="comment">// bind a simple user interface, etc. etc.)</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app.html">ChIrrApp</a> application(&amp;my_system, L<span class="stringliteral">&quot;Modeling a simplified   tank&quot;</span>, core::dimension2d&lt;u32&gt;(800, 600), <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Easy shortcuts to add logo, camera, lights and sky in Irrlicht scene:</span></div><div class="line">    ChIrrWizard::add_typical_Logo(application.GetDevice());</div><div class="line">    ChIrrWizard::add_typical_Sky(application.GetDevice());</div><div class="line">    ChIrrWizard::add_typical_Lights(application.GetDevice());</div><div class="line">    ChIrrWizard::add_typical_Camera(application.GetDevice(), core::vector3df(0, 0, -6), core::vector3df(-2, 2, 0));</div><div class="line"></div><div class="line">    <span class="comment">// 2- Create the rigid bodies of the simpified tank suspension mechanical system</span></div><div class="line">    <span class="comment">//   maybe setting position/mass/inertias of</span></div><div class="line">    <span class="comment">//   their center of mass (COG) etc.</span></div><div class="line"></div><div class="line">    <span class="comment">// ..the world</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_body_scene_node.html">ChBodySceneNode</a>* my_ground = (<a class="code" href="classchrono_1_1irrlicht_1_1_ch_body_scene_node.html">ChBodySceneNode</a>*)<a class="code" href="group__irrlicht__module.html#ga88caf7f14bd9e3ec92b5f4738e43441f">addChBodySceneNode_easyBox</a>(</div><div class="line">        &amp;my_system, application.GetSceneManager(), 1.0, ChVector&lt;&gt;(0, -1, 0), QUNIT, ChVector&lt;&gt;(60, 2, 60));</div><div class="line">    my_ground-&gt;GetBody()-&gt;SetBodyFixed(<span class="keyword">true</span>);</div><div class="line">    my_ground-&gt;GetBody()-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line">    my_ground-&gt;GetBody()-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">    video::ITexture* groundMap = application.GetVideoDriver()-&gt;getTexture(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;blu.png&quot;</span>).c_str());</div><div class="line">    my_ground-&gt;setMaterialTexture(0, groundMap);</div><div class="line"></div><div class="line">    <span class="comment">// ..some obstacles on the ground:</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 50; i++) {</div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_body_scene_node.html">ChBodySceneNode</a>* my_obstacle = (<a class="code" href="classchrono_1_1irrlicht_1_1_ch_body_scene_node.html">ChBodySceneNode</a>*)<a class="code" href="group__irrlicht__module.html#ga88caf7f14bd9e3ec92b5f4738e43441f">addChBodySceneNode_easyBox</a>(</div><div class="line">            &amp;my_system, application.GetSceneManager(), 3.0,</div><div class="line">            ChVector&lt;&gt;(-6 + 6 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>(), 2 + 1 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>(), 6 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>()),</div><div class="line">            Q_from_AngAxis(<a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>() * CH_C_PI, VECT_Y),</div><div class="line">            ChVector&lt;&gt;(0.6 * (1 - 0.4 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>()), 0.08, 0.3 * (1 - 0.4 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>())));</div><div class="line">        my_obstacle-&gt;addShadowVolumeSceneNode();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// ..the tank (this class - see above - is a &#39;set&#39; of bodies and links, automatically added at creation)</span></div><div class="line">    MySimpleTank* mytank = <span class="keyword">new</span> MySimpleTank(my_system, application.GetSceneManager(), application.GetVideoDriver());</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// Use this function for adding a ChIrrNodeAsset to all items</span></div><div class="line">    <span class="comment">// Otherwise use application.AssetBind(myitem); on a per-item basis.</span></div><div class="line">    application.AssetBindAll();</div><div class="line"></div><div class="line">    <span class="comment">// Use this function for &#39;converting&#39; assets into Irrlicht meshes</span></div><div class="line">    application.AssetUpdateAll();</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// USER INTERFACE</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">// Create some graphical-user-interface (GUI) items to show on the screen.</span></div><div class="line">    <span class="comment">// This requires an event receiver object.</span></div><div class="line">    MyEventReceiver receiver(&amp;application, mytank);</div><div class="line">    <span class="comment">// note how to add the custom event receiver to the default interface:</span></div><div class="line">    application.SetUserEventReceiver(&amp;receiver);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// SETTINGS</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0fec5297a93785df11a4dd5409346f2c">SetMaxItersSolverSpeed</a>(100);  <span class="comment">// the higher, the easier to keep the constraints &#39;mounted&#39;.</span></div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_system.html#a8420bd0eed767607295d15092302ffc9">SetSolverType</a>(ChSystem::SOLVER_SOR);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// THE SOFT-REAL-TIME CYCLE, SHOWING THE SIMULATION</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    application.SetStepManage(<span class="keyword">true</span>);</div><div class="line">    application.SetTimestep(0.03);</div><div class="line">    application.SetTryRealtime(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (application.GetDevice()-&gt;run()) {</div><div class="line">        <span class="comment">// Irrlicht must prepare frame to draw</span></div><div class="line">        application.GetVideoDriver()-&gt;beginScene(<span class="keyword">true</span>, <span class="keyword">true</span>, SColor(255, 140, 161, 192));</div><div class="line"></div><div class="line">        <span class="comment">// .. draw solid 3D items (boxes, cylinders, shapes) belonging to Irrlicht scene, if any</span></div><div class="line">        application.DrawAll();</div><div class="line"></div><div class="line">        <span class="comment">// .. draw also a grid (rotated so that it&#39;s horizontal)</span></div><div class="line">        ChIrrTools::drawGrid(application.GetVideoDriver(), 2, 2, 30, 30,</div><div class="line">                             <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(0, 0.01, 0), Q_from_AngX(CH_C_PI_2)),</div><div class="line">                             video::SColor(255, 60, 60, 60), <span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <span class="comment">// HERE CHRONO INTEGRATION IS PERFORMED:</span></div><div class="line"></div><div class="line">        application.DoStep();</div><div class="line"></div><div class="line">        application.GetVideoDriver()-&gt;endScene();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (mytank)</div><div class="line">        <span class="keyword">delete</span> mytank;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 1 2016 15:43:11 for Project Chrono by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11 . <a href="mailto:info@projectchrono.org">Contact us</a> for issues related to this page. 
</small></address>
</body>
</html>
