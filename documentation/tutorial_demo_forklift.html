<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>Project Chrono: Forklift example (demo_forklift.cpp)</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://projectchrono.org">
            <span class="logo first">PROJECT</span><span class="logo second">CHRONO</span>
        </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://projectchrono.org/download">Download</a></li>
        <li class="dropdown">
            <a href="http://api.chrono.projectchrono.org" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://api.chrono.projectchrono.org/faq_root.html">FAQ</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_table_of_content_install.html">Install Guide</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_root.html">Examples/Tutorials</a></li>
                <li><a href="http://api.chrono.projectchrono.org/model_root.html">Model Library</a></li>
                <li><a href="http://api.chrono.projectchrono.org/validation_studies_root.html">Validation Studies</a></li>
                <li><a href="http://api.chrono.projectchrono.org/whitepaper_root.html">White Papers</a></li>
                <li><a href="http://projectchrono.org/docpdf">PDF Version</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="http://projectchrono.org/gallery/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" style="dropdown:hover" aria-haspopup="true" aria-expanded="false">Movies <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/gallery/">Gallery</a></li>
                <li><a href="http://sbel.wisc.edu/Animations/">SBEL</a></li>
                <li><a href="https://vimeo.com/uwsbel">On Vimeo</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/news/">News</a></li>
        <li><a href="http://projectchrono.org/forum">Forum</a></li>
		<li class="dropdown">
            <a href="http://projectchrono.org/about/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/about/">What is ProjectChrono</a></li>
                <li><a href="http://projectchrono.org/testimonials/">Users</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/status">Status</a></li>            
            <li>
              <form method="get" action="http://projectchrono.org/search" id="search_bar_triggered">
                          <input type="submit" value="Search">
                <input type="text" id="search_bar" name="query" value="" />
              </form> 
            </li>
    </ul>
          <!-- <ul class="nav navbar-nav navbar-right">
      </ul> -->
  </div><!--/.navbar-collapse -->
</div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Project Chrono API/SDK documentation</a></li><li class="navelem"><a class="el" href="manual_root.html">Reference Manual</a></li><li class="navelem"><a class="el" href="tutorial_root.html">Tutorials</a></li><li class="navelem"><a class="el" href="tutorial_table_of_content_chrono_irrlicht.html">Chrono IRRLICHT module tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Forklift example (demo_forklift.cpp) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Advanced tutorial.</p>
<p>Create a forklift and control it using the keyboard. The forklift collides with a pallet, that can be moved with the fork.</p>
<p>Learn about:</p>
<ul>
<li>how to use collisions for complex shapes</li>
<li>how to use the Irrlicht GUI keyboard events</li>
<li>how to create some constraints, including a simplified motor</li>
<li>how to load .OBJ meshes for visualization etc.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// PROJECT CHRONO - http://projectchrono.org</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Copyright (c) 2010-2011 Alessandro Tasora</span></div><div class="line"><span class="comment">// Copyright (c) 2013 Project Chrono</span></div><div class="line"><span class="comment">// All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div><div class="line"><span class="comment">// found in the LICENSE file at the top level of the distribution</span></div><div class="line"><span class="comment">// and at http://projectchrono.org/license-chrono.txt.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   Demo code about</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     - modeling a complex mechanism:  a forklift</span></div><div class="line"><span class="comment">//     - loading .obj 3D meshes for 3d viewing</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       CHRONO</span></div><div class="line"><span class="comment">//   ------</span></div><div class="line"><span class="comment">//   Multibody dinamics engine</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment">//             http://www.projectchrono.org</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="preprocessor">#include &quot;chrono/core/ChRealtimeStep.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChSystem.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChBodyEasy.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChLinkLinActuator.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/assets/ChTexture.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChBodySceneNodeTools.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChIrrApp.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;irrlicht.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Use the namespaces of Chrono</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono.html">chrono</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono_1_1irrlicht.html">chrono::irrlicht</a>;</div><div class="line"></div><div class="line"><span class="comment">// Use the main namespaces of Irrlicht</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr.html">irr</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1core.html">irr::core</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1scene.html">irr::scene</a>;</div><div class="line"><span class="keyword">using namespace </span>irr::video;</div><div class="line"><span class="keyword">using namespace </span>irr::io;</div><div class="line"><span class="keyword">using namespace </span>irr::gui;</div><div class="line"></div><div class="line"><span class="comment">// First of all, define a class for the &#39;forklift&#39; (that is, a set of</span></div><div class="line"><span class="comment">// bodies and links which are grouped within this class; so it is</span></div><div class="line"><span class="comment">// easier to manage data structures in this example).</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MySimpleForklift {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    <span class="comment">// THE DATA</span></div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> throttle;  <span class="comment">// actual value 0...1 of gas throttle.</span></div><div class="line">    <span class="keywordtype">double</span> steer;     <span class="comment">// actual value of steering</span></div><div class="line">    <span class="keywordtype">double</span> lift;      <span class="comment">// actual value of fork lifting</span></div><div class="line"></div><div class="line">    <span class="comment">// The parts making the forklift, as 3d Irrlicht scene nodes, each containing</span></div><div class="line">    <span class="comment">// the ChBody object</span></div><div class="line">    <span class="comment">// .. truss:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; truss;</div><div class="line">    <span class="comment">// .. right front wheel:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelRF;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteRF;</div><div class="line">    <span class="comment">// .. left front wheel:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelLF;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteLF;</div><div class="line">    <span class="comment">// .. back wheel:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; spindleB;</div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelB;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_steer_engineB;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_engineB;</div><div class="line">    <span class="comment">// ..the vertical arm</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; arm;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_engineArm;</div><div class="line">    <span class="comment">// ..the fork</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; fork;</div><div class="line">    std::shared_ptr&lt;ChLinkLinActuator&gt; link_actuatorFork;</div><div class="line">    std::shared_ptr&lt;ChLinkLockPrismatic&gt; link_prismaticFork;</div><div class="line"></div><div class="line">    video::ITexture* forkliftTiremap;</div><div class="line"></div><div class="line">    <span class="comment">// THE FUNCTIONS</span></div><div class="line"></div><div class="line">    <span class="comment">// Build and initialize the forklift, creating all bodies corresponding to</span></div><div class="line">    <span class="comment">// the various parts and adding them to the physical system - also creating</span></div><div class="line">    <span class="comment">// and adding constraints to the system.</span></div><div class="line">    MySimpleForklift(<a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app_interface.html">ChIrrAppInterface</a>* app, ChVector&lt;&gt; offset = ChVector&lt;&gt;(0, 0, 0)) {</div><div class="line">        throttle = 0;  <span class="comment">// initially, gas throttle is 0.</span></div><div class="line">        steer = 0;</div><div class="line">        lift = 0;</div><div class="line"></div><div class="line">        ChVector&lt;&gt; COG_truss(0, 0.4, 0.5);</div><div class="line">        ChVector&lt;&gt; COG_wheelRF(-0.566, 0.282, 1.608);</div><div class="line">        ChVector&lt;&gt; COG_wheelLF(0.566, 0.282, 1.608);</div><div class="line">        ChVector&lt;&gt; COG_arm(0, 1.300, 1.855);</div><div class="line">        ChVector&lt;&gt; COG_fork(0, 0.362, 2.100);</div><div class="line">        ChVector&lt;&gt; COG_wheelB(0, 0.282, 0.003);</div><div class="line">        ChVector&lt;&gt; POS_pivotarm(0, 0.150, 1.855);</div><div class="line">        ChVector&lt;&gt; POS_prismatic(0, 0.150, 1.855);</div><div class="line">        <span class="keywordtype">double</span> RAD_back_wheel = 0.28;</div><div class="line">        <span class="keywordtype">double</span> RAD_front_wheel = 0.28;</div><div class="line"></div><div class="line">        forkliftTiremap = app-&gt;GetVideoDriver()-&gt;getTexture(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;tire_truck.png&quot;</span>).c_str());</div><div class="line"></div><div class="line">        <span class="comment">// --- The car body ---</span></div><div class="line"></div><div class="line">        truss = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(truss);</div><div class="line">        truss-&gt;SetPos(COG_truss);</div><div class="line">        truss-&gt;SetMass(200);</div><div class="line">        truss-&gt;SetInertiaXX(ChVector&lt;&gt;(100, 100, 100));</div><div class="line">         <span class="comment">// collision properties:</span></div><div class="line">        truss-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        truss-&gt;GetCollisionModel()-&gt;AddBox(1.227 / 2., 1.621 / 2., 1.864 / 2., ChVector&lt;&gt;(-0.003, 1.019, 0.192));</div><div class="line">        truss-&gt;GetCollisionModel()-&gt;AddBox(0.187 / 2., 0.773 / 2., 1.201 / 2., ChVector&lt;&gt;(0.486, 0.153, -0.047));</div><div class="line">        truss-&gt;GetCollisionModel()-&gt;AddBox(0.187 / 2., 0.773 / 2., 1.201 / 2., ChVector&lt;&gt;(-0.486, 0.153, -0.047));</div><div class="line">        truss-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        truss-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line">         <span class="comment">// visualization properties:</span></div><div class="line">        <span class="keyword">auto</span> truss_asset_assembly = std::make_shared&lt;ChAssetLevel&gt;();</div><div class="line">        truss_asset_assembly-&gt;GetFrame().SetPos(-COG_truss);</div><div class="line">        truss-&gt;AddAsset(truss_asset_assembly);</div><div class="line">        <span class="keyword">auto</span> truss_mesh = std::make_shared&lt;ChObjShapeFile&gt;();</div><div class="line">        truss_mesh-&gt;SetFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;forklift_body.obj&quot;</span>));</div><div class="line">        truss_asset_assembly-&gt;AddAsset(truss_mesh);</div><div class="line">        <span class="keyword">auto</span> truss_texture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;tire_truck.png&quot;</span>));</div><div class="line">        truss_asset_assembly-&gt;AddAsset(truss_texture);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// ..the right-front wheel</span></div><div class="line"></div><div class="line">        wheelRF = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelRF);</div><div class="line">        wheelRF-&gt;SetPos(COG_wheelRF);</div><div class="line">        wheelRF-&gt;SetMass(20);</div><div class="line">        wheelRF-&gt;SetInertiaXX(ChVector&lt;&gt;(2, 2, 2));</div><div class="line">         <span class="comment">// collision properties:</span></div><div class="line">        <a class="code" href="classchrono_1_1_ch_matrix33.html">ChMatrix33&lt;&gt;</a> Arot(chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;AddCylinder(RAD_front_wheel, RAD_front_wheel, 0.1, ChVector&lt;&gt;(0, 0, 0), Arot);</div><div class="line">        wheelRF-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        wheelRF-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line">         <span class="comment">// visualization properties:</span></div><div class="line">        <span class="keyword">auto</span> wheelRF_asset_assembly = std::make_shared&lt;ChAssetLevel&gt;();</div><div class="line">        wheelRF_asset_assembly-&gt;GetFrame().SetPos(-COG_wheelRF);</div><div class="line">        wheelRF-&gt;AddAsset(wheelRF_asset_assembly);</div><div class="line">        <span class="keyword">auto</span> wheelRF_mesh = std::make_shared&lt;ChObjShapeFile&gt;();</div><div class="line">        wheelRF_mesh-&gt;SetFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel.obj&quot;</span>));</div><div class="line">        wheelRF_asset_assembly-&gt;AddAsset(wheelRF_mesh);</div><div class="line">        <span class="keyword">auto</span> wheelRF_texture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;tire_truck.png&quot;</span>));</div><div class="line">        wheelRF_asset_assembly-&gt;AddAsset(wheelRF_texture);</div><div class="line">      </div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the truss</span></div><div class="line">        </div><div class="line">        link_revoluteRF = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// right, front, upper, 1</span></div><div class="line">        link_revoluteRF-&gt;Initialize(wheelRF, truss,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(COG_wheelRF, chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteRF);</div><div class="line"></div><div class="line">        <span class="comment">// ..the left-front wheel</span></div><div class="line"></div><div class="line">        wheelLF = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelLF);</div><div class="line">        wheelLF-&gt;SetPos(COG_wheelLF);</div><div class="line">        wheelLF-&gt;SetRot(chrono::Q_from_AngAxis(CH_C_PI, VECT_Y));  <span class="comment">// reuse RF wheel shape, flipped</span></div><div class="line">        wheelLF-&gt;SetMass(20);</div><div class="line">        wheelLF-&gt;SetInertiaXX(ChVector&lt;&gt;(2, 2, 2));</div><div class="line">         <span class="comment">// collision properties:</span></div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;AddCylinder(RAD_front_wheel, RAD_front_wheel, 0.1, ChVector&lt;&gt;(0, 0, 0), Arot);</div><div class="line">        wheelLF-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        wheelLF-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line">         <span class="comment">// visualization properties:</span></div><div class="line">        <span class="keyword">auto</span> wheelLF_asset_assembly = std::make_shared&lt;ChAssetLevel&gt;();</div><div class="line">        wheelLF_asset_assembly-&gt;GetFrame().SetPos(-COG_wheelRF);</div><div class="line">        wheelLF-&gt;AddAsset(wheelLF_asset_assembly);</div><div class="line">        <span class="keyword">auto</span> wheelLF_mesh = std::make_shared&lt;ChObjShapeFile&gt;();</div><div class="line">        wheelLF_mesh-&gt;SetFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel.obj&quot;</span>));</div><div class="line">        wheelLF_asset_assembly-&gt;AddAsset(wheelLF_mesh);</div><div class="line">        <span class="keyword">auto</span> wheelLF_texture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;tire_truck.png&quot;</span>));</div><div class="line">        wheelLF_asset_assembly-&gt;AddAsset(wheelLF_texture);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the truss</span></div><div class="line">        link_revoluteLF = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// right, front, upper, 1</span></div><div class="line">        link_revoluteLF-&gt;Initialize(wheelLF, truss,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(COG_wheelLF, chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteLF);</div><div class="line"></div><div class="line">        <span class="comment">// ..the back steering spindle (invisible, no mesh)</span></div><div class="line">        spindleB = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(spindleB);</div><div class="line">        spindleB-&gt;SetPos(COG_wheelB);</div><div class="line">        spindleB-&gt;SetMass(10);</div><div class="line">        spindleB-&gt;SetInertiaXX(ChVector&lt;&gt;(1, 1, 1));</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// .. create the vertical steering link between the spindle structure and the truss</span></div><div class="line">        link_steer_engineB = std::make_shared&lt;ChLinkEngine&gt;();</div><div class="line">        link_steer_engineB-&gt;Initialize(</div><div class="line">            spindleB, truss,</div><div class="line">            <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(COG_wheelB, chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_X)));  <span class="comment">// vertical axis</span></div><div class="line">        link_steer_engineB-&gt;Set_shaft_mode(<a class="code" href="classchrono_1_1_ch_link_engine.html#ac98a88a282435b5459d1fc656319939eafe457c16213e77680fba4f17aeebc0d9">ChLinkEngine::ENG_SHAFT_LOCK</a>);</div><div class="line">        link_steer_engineB-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_ROTATION);</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_steer_engineB);</div><div class="line"></div><div class="line">        <span class="comment">// ..the back wheel</span></div><div class="line"></div><div class="line">        wheelB = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(wheelB);</div><div class="line">        wheelB-&gt;SetPos(COG_wheelB);</div><div class="line">        wheelB-&gt;SetRot(chrono::Q_from_AngAxis(CH_C_PI, VECT_Y));  <span class="comment">// reuse RF wheel shape, flipped</span></div><div class="line">        wheelB-&gt;SetMass(20);</div><div class="line">        wheelB-&gt;SetInertiaXX(ChVector&lt;&gt;(2, 2, 2));</div><div class="line">         <span class="comment">// collision properties:</span></div><div class="line">        wheelB-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        wheelB-&gt;GetCollisionModel()-&gt;AddCylinder(RAD_back_wheel, RAD_back_wheel, 0.1, ChVector&lt;&gt;(0, 0, 0), Arot);</div><div class="line">        wheelB-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        wheelB-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">         <span class="comment">// visualization properties:</span></div><div class="line">        <span class="keyword">auto</span> wheelB_asset_assembly = std::make_shared&lt;ChAssetLevel&gt;();</div><div class="line">        wheelB_asset_assembly-&gt;GetFrame().SetPos(-COG_wheelRF);</div><div class="line">        wheelB-&gt;AddAsset(wheelB_asset_assembly);</div><div class="line">        <span class="keyword">auto</span> wheelB_mesh = std::make_shared&lt;ChObjShapeFile&gt;();</div><div class="line">        wheelB_mesh-&gt;SetFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;wheel.obj&quot;</span>));</div><div class="line">        wheelB_asset_assembly-&gt;AddAsset(wheelB_mesh);</div><div class="line">        <span class="keyword">auto</span> wheelB_texture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;tire_truck.png&quot;</span>));</div><div class="line">        wheelB_asset_assembly-&gt;AddAsset(wheelB_texture);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// .. create the motor between the back wheel and the steering spindle structure</span></div><div class="line">        link_engineB = std::make_shared&lt;ChLinkEngine&gt;();</div><div class="line">        link_engineB-&gt;Initialize(wheelB, spindleB,</div><div class="line">                                 <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(COG_wheelB, chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        link_engineB-&gt;Set_shaft_mode(<a class="code" href="classchrono_1_1_ch_link_engine.html#ac98a88a282435b5459d1fc656319939eafe457c16213e77680fba4f17aeebc0d9">ChLinkEngine::ENG_SHAFT_LOCK</a>);</div><div class="line">        link_engineB-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_SPEED);</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_engineB);</div><div class="line"></div><div class="line">        <span class="comment">// ..the arm</span></div><div class="line">        arm = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(arm);</div><div class="line">        arm-&gt;SetPos(COG_arm);</div><div class="line">        arm-&gt;SetMass(100);</div><div class="line">        arm-&gt;SetInertiaXX(ChVector&lt;&gt;(30, 30, 30));</div><div class="line">         <span class="comment">// visualization properties:</span></div><div class="line">        <span class="keyword">auto</span> arm_asset_assembly = std::make_shared&lt;ChAssetLevel&gt;();</div><div class="line">        arm_asset_assembly-&gt;GetFrame().SetPos(-COG_arm);</div><div class="line">        arm-&gt;AddAsset(arm_asset_assembly);</div><div class="line">        <span class="keyword">auto</span> arm_mesh = std::make_shared&lt;ChObjShapeFile&gt;();</div><div class="line">        arm_mesh-&gt;SetFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;forklift_arm.obj&quot;</span>));</div><div class="line">        arm_asset_assembly-&gt;AddAsset(arm_mesh);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the arm and the truss</span></div><div class="line">        link_engineArm = std::make_shared&lt;ChLinkEngine&gt;();  <span class="comment">// right, front, upper, 1</span></div><div class="line">        link_engineArm-&gt;Initialize(arm, truss,</div><div class="line">                                   <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(POS_pivotarm, chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        link_engineArm-&gt;Set_shaft_mode(<a class="code" href="classchrono_1_1_ch_link_engine.html#ac98a88a282435b5459d1fc656319939eafe457c16213e77680fba4f17aeebc0d9">ChLinkEngine::ENG_SHAFT_LOCK</a>);</div><div class="line">        link_engineArm-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_ROTATION);</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_engineArm);</div><div class="line"></div><div class="line">        <span class="comment">// ..the fork</span></div><div class="line"></div><div class="line">        fork = std::make_shared&lt;ChBody&gt;();</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(fork);</div><div class="line">        fork-&gt;SetPos(COG_fork);</div><div class="line">        fork-&gt;SetMass(60);</div><div class="line">        fork-&gt;SetInertiaXX(ChVector&lt;&gt;(15, 15, 15));</div><div class="line">         <span class="comment">// collision properties:</span></div><div class="line">        fork-&gt;GetCollisionModel()-&gt;ClearModel();</div><div class="line">        fork-&gt;GetCollisionModel()-&gt;AddBox(0.1 / 2., 0.032 / 2., 1.033 / 2.,ChVector&lt;&gt;(-0.352, -0.312, 0.613));</div><div class="line">        fork-&gt;GetCollisionModel()-&gt;AddBox(0.1 / 2., 0.032 / 2., 1.033 / 2., ChVector&lt;&gt;(0.352, -0.312, 0.613));</div><div class="line">        fork-&gt;GetCollisionModel()-&gt;AddBox(0.344 / 2., 1.134 / 2., 0.101 / 2., ChVector&lt;&gt;(-0.000, 0.321, -0.009));</div><div class="line">        fork-&gt;GetCollisionModel()-&gt;BuildModel();</div><div class="line">        fork-&gt;SetCollide(<span class="keyword">true</span>);</div><div class="line">         <span class="comment">// visualization properties:</span></div><div class="line">        <span class="keyword">auto</span> fork_asset_assembly = std::make_shared&lt;ChAssetLevel&gt;();</div><div class="line">        fork_asset_assembly-&gt;GetFrame().SetPos(-COG_fork);</div><div class="line">        fork-&gt;AddAsset(fork_asset_assembly);</div><div class="line">        <span class="keyword">auto</span> fork_mesh = std::make_shared&lt;ChObjShapeFile&gt;();</div><div class="line">        fork_mesh-&gt;SetFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;forklift_forks.obj&quot;</span>));</div><div class="line">        fork_asset_assembly-&gt;AddAsset(fork_mesh);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// .. create the prismatic joint between the fork and arm</span></div><div class="line">        link_prismaticFork = std::make_shared&lt;ChLinkLockPrismatic&gt;();</div><div class="line">        link_prismaticFork-&gt;Initialize(</div><div class="line">            fork, arm,</div><div class="line">            <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(</div><div class="line">                POS_prismatic,</div><div class="line">                chrono::Q_from_AngAxis(CH_C_PI / 2,</div><div class="line">                                       VECT_X)));  <span class="comment">// set prism as vertical (default would be aligned to z, horizontal</span></div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_prismaticFork);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the linear actuator that pushes upward the fork</span></div><div class="line">        link_actuatorFork = std::make_shared&lt;ChLinkLinActuator&gt;();</div><div class="line">        link_actuatorFork-&gt;Initialize(fork, arm, <span class="keyword">false</span>,</div><div class="line">                                      <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(POS_prismatic + ChVector&lt;&gt;(0, 0.01, 0), QUNIT),</div><div class="line">                                      <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(POS_prismatic, QUNIT));</div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_actuatorFork);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// ..a pallet</span></div><div class="line"></div><div class="line">        <span class="keyword">auto</span> pallet = std::make_shared&lt;ChBodyEasyMesh&gt;(</div><div class="line">            <a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;pallet.obj&quot;</span>),  <span class="comment">// mesh .OBJ file</span></div><div class="line">            300,                              <span class="comment">// density</span></div><div class="line">            <span class="keyword">true</span>,   <span class="comment">// compute mass, inertia &amp; COG from the mesh (must be a closed watertight mesh!)</span></div><div class="line">            <span class="keyword">true</span>,   <span class="comment">// enable collision with mesh</span></div><div class="line">            0.001,  <span class="comment">// sphere swept inflate of mesh - improves robustness of collision detection</span></div><div class="line">            <span class="keyword">true</span>);  <span class="comment">// enable visualization of mesh</span></div><div class="line">        app-&gt;GetSystem()-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(pallet);</div><div class="line">        pallet-&gt;SetPos(ChVector&lt;&gt;(0, 0.4, 3));</div><div class="line">        </div><div class="line">        <span class="comment">// apply also a texture to the pallet:</span></div><div class="line">        <span class="keyword">auto</span> pallet_texture = std::make_shared&lt;ChTexture&gt;();</div><div class="line">        pallet_texture-&gt;SetTextureFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;cubetexture.png&quot;</span>));</div><div class="line">        pallet-&gt;AddAsset(pallet_texture);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// Move the forklift to initial offset position</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">//                              pallet-&gt;GetBody()-&gt;Move(offset);</span></div><div class="line">        truss-&gt;Move(offset);</div><div class="line">        wheelRF-&gt;Move(offset);</div><div class="line">        wheelLF-&gt;Move(offset);</div><div class="line">        wheelB-&gt;Move(offset);</div><div class="line">        spindleB-&gt;Move(offset);</div><div class="line">        arm-&gt;Move(offset);</div><div class="line">        fork-&gt;Move(offset);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Delete the car object, deleting also all bodies corresponding to</span></div><div class="line">    <span class="comment">// the various parts and removing them from the physical system.  Also</span></div><div class="line">    <span class="comment">// removes constraints from the system.</span></div><div class="line">    ~MySimpleForklift() {</div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>* mysystem = truss-&gt;<a class="code" href="classchrono_1_1_ch_physics_item.html#a87da1034f53c53e8971259dd269bdfe0">GetSystem</a>();  <span class="comment">// trick to get the system here</span></div><div class="line"></div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_revoluteRF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_revoluteLF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_steer_engineB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_engineB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_engineArm);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_prismaticFork);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(link_actuatorFork);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(truss);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelRF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelLF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(wheelB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(spindleB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(arm);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ae8d0bdd68eba9e24d0f06f9b0f39199c">Remove</a>(fork);</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// Define a MyEventReceiver class which will be used to manage input</span></div><div class="line"><span class="comment">// from the GUI graphical user interface (the interface will</span></div><div class="line"><span class="comment">// be created with the basic -yet flexible- platform</span></div><div class="line"><span class="comment">// independent toolset of Irrlicht).</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MyEventReceiver : <span class="keyword">public</span> IEventReceiver {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    MyEventReceiver(<a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app_interface.html">ChIrrAppInterface</a>* myapp, MySimpleForklift* mlift) {</div><div class="line">        <span class="comment">// store pointer to physical system &amp; other stuff so we can tweak them by user keyboard</span></div><div class="line">        app = myapp;</div><div class="line">        forklift = mlift;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">bool</span> OnEvent(<span class="keyword">const</span> SEvent&amp; event) {</div><div class="line">        <span class="comment">// check if user presses keys</span></div><div class="line">        <span class="keywordflow">if</span> (event.EventType == irr::EET_KEY_INPUT_EVENT &amp;&amp; !event.KeyInput.PressedDown) {</div><div class="line">            <span class="keywordflow">switch</span> (event.KeyInput.Key) {</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_Q:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_steer_engineB-&gt;Get_rot_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(-0.6 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_W:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_steer_engineB-&gt;Get_rot_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(+0.3 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_A:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_engineB-&gt;Get_spe_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(0.5 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_Z:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_engineB-&gt;Get_spe_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(-0.5 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_S:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_actuatorFork-&gt;Get_dist_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(0.05 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_X:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_actuatorFork-&gt;Get_dist_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(-0.05 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_D:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_engineArm-&gt;Get_rot_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(0.005 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">                <span class="keywordflow">case</span> irr::KEY_KEY_C:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(forklift-&gt;link_engineArm-&gt;Get_rot_funct()))</div><div class="line">                        mfun-&gt;Set_yconst(-0.005 + mfun-&gt;Get_yconst());</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app_interface.html">ChIrrAppInterface</a>* app;</div><div class="line">    MySimpleForklift* forklift;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// This is the program which is executed</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">    <span class="comment">// Create a ChronoENGINE physical system</span></div><div class="line">    <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">    <span class="comment">// Create the Irrlicht visualization (open the Irrlicht device,</span></div><div class="line">    <span class="comment">// bind a simple user interface, etc. etc.)</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app.html">ChIrrApp</a> application(&amp;my_system, L<span class="stringliteral">&quot;Drive a forklift&quot;</span>, core::dimension2d&lt;u32&gt;(800, 600), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">// add text with info</span></div><div class="line">    IGUIStaticText* textFPS = application.GetIGUIEnvironment()-&gt;addStaticText(</div><div class="line">        L<span class="stringliteral">&quot;Keys: steer=Q,W; throttle=A,Z; lift=S,X; bank=D,C&quot;</span>, rect&lt;s32&gt;(150, 10, 430, 40), <span class="keyword">true</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Easy shortcuts to add logo, camera, lights and sky in Irrlicht scene:</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#ae185d295a9a02352688166c2c6665234">ChIrrWizard::add_typical_Logo</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#ab3087fe4418963f09727a91f43562129">ChIrrWizard::add_typical_Sky</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#aa990918e4e1113997fee29ba82083ab1">ChIrrWizard::add_typical_Lights</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#add550a0cc283f166db49d39e50f76c0b">ChIrrWizard::add_typical_Camera</a>(application.GetDevice(), core::vector3df(-6, 3, -6));</div><div class="line"></div><div class="line">    <span class="comment">// ..the world</span></div><div class="line">    <span class="keyword">auto</span> my_ground = std::make_shared&lt;ChBodyEasyBox&gt;(40, 2, 40, 1000, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_ground);</div><div class="line">    my_ground-&gt;SetBodyFixed(<span class="keyword">true</span>);</div><div class="line">    my_ground-&gt;SetPos(ChVector&lt;&gt;(0, -1, 0));</div><div class="line">    my_ground-&gt;GetMaterialSurface()-&gt;SetSfriction(1.0);</div><div class="line">    my_ground-&gt;GetMaterialSurface()-&gt;SetKfriction(1.0);</div><div class="line">    <span class="keyword">auto</span> mtexture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;concrete.jpg&quot;</span>));</div><div class="line">    my_ground-&gt;AddAsset(mtexture);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// ..some obstacles on the ground:</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div><div class="line">        <span class="keyword">auto</span> my_obstacle = std::make_shared&lt;ChBodyEasyBox&gt;(1, 0.5, 1, 200, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_obstacle);</div><div class="line">        my_obstacle-&gt;SetPos(ChVector&lt;&gt;(20 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>(), 2, 20 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>()));</div><div class="line">        my_obstacle-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        <span class="keyword">auto</span> mtexture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;cubetexture_wood.png&quot;</span>));</div><div class="line">        my_obstacle-&gt;AddAsset(mtexture);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// ..the forklift (this class - see above - is a &#39;set&#39; of bodies and links, automatically added at creation)</span></div><div class="line">    MySimpleForklift* myforklift = <span class="keyword">new</span> MySimpleForklift(&amp;application);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// Use this function for adding a ChIrrNodeAsset to all items</span></div><div class="line">    <span class="comment">// Otherwise use application.AssetBind(myitem); on a per-item basis.</span></div><div class="line">    application.AssetBindAll();</div><div class="line"></div><div class="line">    <span class="comment">// Use this function for &#39;converting&#39; assets into Irrlicht meshes</span></div><div class="line">    application.AssetUpdateAll();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// USER INTERFACE</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">// Create some graphical-user-interface (GUI) items to show on the screen.</span></div><div class="line">    <span class="comment">// This requires an event receiver object -see above.</span></div><div class="line">    <span class="comment">// This is for GUI tweaking of system parameters..</span></div><div class="line">    MyEventReceiver receiver(&amp;application, myforklift);</div><div class="line">    <span class="comment">// note how to add a custom event receiver to the default interface:</span></div><div class="line">    application.SetUserEventReceiver(&amp;receiver);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// SETTINGS</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0fec5297a93785df11a4dd5409346f2c">SetMaxItersSolverSpeed</a>(20);  <span class="comment">// the higher, the easier to keep the constraints &#39;mounted&#39;.</span></div><div class="line"></div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_system.html#a8420bd0eed767607295d15092302ffc9">SetSolverType</a>(ChSystem::SOLVER_SOR);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// THE SOFT-REAL-TIME CYCLE, SHOWING THE SIMULATION</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">// This will help choosing an integration step which matches the</span></div><div class="line">    <span class="comment">// real-time step of the simulation..</span></div><div class="line">    application.SetStepManage(<span class="keyword">true</span>);</div><div class="line">    application.SetTimestep(0.005);</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (application.GetDevice()-&gt;run()) {</div><div class="line">        <span class="comment">// Irrlicht must prepare frame to draw</span></div><div class="line">        application.GetVideoDriver()-&gt;beginScene(<span class="keyword">true</span>, <span class="keyword">true</span>, SColor(255, 140, 161, 192));</div><div class="line"></div><div class="line">        <span class="comment">// Irrlicht application draws all 3D objects and all GUI items</span></div><div class="line">        application.DrawAll();</div><div class="line"></div><div class="line">        <span class="comment">// Advance the simulation time step</span></div><div class="line">        application.DoStep();</div><div class="line"></div><div class="line">        <span class="comment">// Irrlicht must finish drawing the frame</span></div><div class="line">        application.GetVideoDriver()-&gt;endScene();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (myforklift)</div><div class="line">        <span class="keyword">delete</span> myforklift;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 1 2016 15:43:10 for Project Chrono by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11 . <a href="mailto:info@projectchrono.org">Contact us</a> for issues related to this page. 
</small></address>
</body>
</html>
