<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>Project Chrono: Creating A Powertrain In Chrono (demo_powertrain.cpp)</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://projectchrono.org">
            <span class="logo first">PROJECT</span><span class="logo second">CHRONO</span>
        </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://projectchrono.org/download">Download</a></li>
        <li class="dropdown">
            <a href="http://api.chrono.projectchrono.org" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://api.chrono.projectchrono.org/faq_root.html">FAQ</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_table_of_content_install.html">Install Guide</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_root.html">Examples/Tutorials</a></li>
                <li><a href="http://api.chrono.projectchrono.org/model_root.html">Model Library</a></li>
                <li><a href="http://api.chrono.projectchrono.org/validation_studies_root.html">Validation Studies</a></li>
                <li><a href="http://api.chrono.projectchrono.org/whitepaper_root.html">White Papers</a></li>
                <li><a href="http://projectchrono.org/docpdf">PDF Version</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="http://projectchrono.org/gallery/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" style="dropdown:hover" aria-haspopup="true" aria-expanded="false">Movies <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/gallery/">Gallery</a></li>
                <li><a href="http://sbel.wisc.edu/Animations/">SBEL</a></li>
                <li><a href="https://vimeo.com/uwsbel">On Vimeo</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/news/">News</a></li>
        <li><a href="http://projectchrono.org/forum">Forum</a></li>
		<li class="dropdown">
            <a href="http://projectchrono.org/about/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/about/">What is ProjectChrono</a></li>
                <li><a href="http://projectchrono.org/testimonials/">Users</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/status">Status</a></li>            
            <li>
              <form method="get" action="http://projectchrono.org/search" id="search_bar_triggered">
                          <input type="submit" value="Search">
                <input type="text" id="search_bar" name="query" value="" />
              </form> 
            </li>
    </ul>
          <!-- <ul class="nav navbar-nav navbar-right">
      </ul> -->
  </div><!--/.navbar-collapse -->
</div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Project Chrono API/SDK documentation</a></li><li class="navelem"><a class="el" href="manual_root.html">Reference Manual</a></li><li class="navelem"><a class="el" href="tutorial_root.html">Tutorials</a></li><li class="navelem"><a class="el" href="tutorial_table_of_content_chrono.html">Chrono core tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Creating A Powertrain In Chrono (demo_powertrain.cpp) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Tutorial covers basic approaches to build systems that embed powertrains made with 1-degree-of-freedom items (rotating shafts):</p>
<ul>
<li>connect 1D shafts with transmission ratios</li>
<li>connect 1D shafts with 1D clutches, brakes, etc.</li>
<li>connect a 1D shaft to a 3D body.</li>
<li>No GUI: only text output.</li>
</ul>
<h2>Example 1: create a simple powertrain with ChShaft objects</h2>
<p>This models a very basic powertrain with two shafts <code>A</code> and <code>B</code>, connected by a reducer <code>[ t ]</code> with transmission ratio <code>t</code>. The shafts are free to rotate. Shaft A has an applied torque <code>Ta</code>, so A and B will constantly accelerate. Each shaft must have some inertia and each one is marked as <code>||</code> in the following scheme: </p><div class="fragment"><div class="line">     A           B</div><div class="line">Ta  ||---[ t ]---||</div></div><!-- fragment --><p> First, create a ChShaft, a 1-degree-of-freedom '1D' mechanical object that can only rotate. It has one inertia value and maybe one applied torque. The ChShaft objects do not have any meaning in 3D, they are just 'building blocks'.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftA-&gt;SetInertia(10);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftA-&gt;SetAppliedTorque(6);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftA);</div></div><!-- fragment --></p>
<p>Next, create another shaft. Note that this falls back on the use of shared pointers for ChShaft objects. Also note that the elements must be added to the ChSystem object that manages this simulation.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftB-&gt;SetInertia(100);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftB-&gt;SetShaftFixed(false);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftB);</div></div><!-- fragment --></p>
<p>Finally, create a ChShaftsGear that represents a simplified model of a reducer with transmission ratio <code>t</code> between two ChShaft objects.</p>
<div class="ce-info"> Note that a full blown 3D powertrain could be created using a collection of rigid bodies of ChBody type that would be connected via ChLinkLockRevolute and ChLinkGear 3D constraints. However, this would introduce additional complexity to the model which is not always warranted. The 1D items of ChShaft type keep the model much simpler. </div><p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaft_gearAB = std::make_shared&lt;ChShaftsGear&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaft_gearAB-&gt;Initialize(my_shaftA, my_shaftB);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaft_gearAB-&gt;SetTransmissionRatio(-0.1);  // ex., a couple of spur gears with 20 and 200 teeth</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaft_gearAB);</div></div><!-- fragment --></p>
<h2>Example 2: a clutch between two shafts</h2>
<p>This models a very basic powertrain with two shafts A and B connected by a clutch <code>[ c ]</code>. Each shaft (see flywheels <code>||</code> in schematic below) starts with a nonzero speed and is free to rotate independently until the clutch is activated. At that point, they will decelerate until they have the same speed. </p><div class="fragment"><div class="line">     A           B</div><div class="line">Ta  ||---[ c ]---||</div></div><!-- fragment --><p>First, create a ChShaft that starts with nonzero angular velocity:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftA-&gt;SetInertia(0.5);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftA-&gt;SetPos_dt(30);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftA);</div></div><!-- fragment --></p>
<p>Next, create another ChShaft with opposite initial angular velocity:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftB-&gt;SetInertia(0.6);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftB-&gt;SetPos_dt(-10);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftB);</div></div><!-- fragment --></p>
<p>Now, create a ChShaftsClutch that represents a simplified model of a clutch between two ChShaft objects (something that limits the max transmitted torque, up to slippage).</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaft_clutchAB = std::make_shared&lt;ChShaftsClutch&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaft_clutchAB-&gt;Initialize(my_shaftA, my_shaftB);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaft_clutchAB-&gt;SetTorqueLimit(60);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaft_clutchAB);</div></div><!-- fragment --></p>
<p>Below, the simulation is started with the clutch disengaged:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        my_shaft_clutchAB-&gt;SetModulation(0);</div></div><!-- fragment --></p>
<h2>Example 3: an epicycloidal reducer</h2>
<p>An epicycloidal reducer is modeled below using the ChShaftsPlanetary constraint.</p>
<p>The ChShaftsPlanetary sets up a kinematic constraint between three shafts. One of them will be <em>fixed</em> and represents the truss of the reducer - in epicycloidaal reducer, this is the role of the large gear with inner teeth. The two remaining shafts are the input and output shafts. In other cases, such as the differential planetary gear of cars, all three shafts are free. A brake is applied on the output shaft - it is enough that one of these last two shafts is fixed.</p>
<p>In the following schematic, the brake is <code>[ b ]</code>, the planetary (the reducer) is <code>[ p ]</code>, the shafts are <code>A,B,C,D</code>, the applied torque is <code>Ta</code>, inertias of free shafts are shown as flywheels <code>||</code> , and fixed shafts are marked with <code>*</code> . </p><div class="fragment"><div class="line">     A           B            D</div><div class="line">Ta  ||---[ p ]---||---[ b ]---*</div><div class="line">         [   ]---*</div><div class="line">                 C</div></div><!-- fragment --><p>First, create shaft A with an applied torque:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftA-&gt;SetInertia(0.5);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftA-&gt;SetAppliedTorque(10);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftA);</div></div><!-- fragment --></p>
<p>Next, create shaft B:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftB-&gt;SetInertia(0.5);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftB);</div></div><!-- fragment --></p>
<p>Create shaft C, which will be fixed (used as truss of epicycloidal reducer):</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftC = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftC-&gt;SetShaftFixed(true);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftC);</div></div><!-- fragment --></p>
<p>Create a ChShaftsPlanetary that represents a simplified model of a planetary gear between <em>three</em> ChShaft objects (e.g., a car differential). An epicycloidal reducer is a special type of planetary gear.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaft_planetaryBAC = std::make_shared&lt;ChShaftsPlanetary&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaft_planetaryBAC-&gt;Initialize(my_shaftB, my_shaftA, my_shaftC);  // output, carrier, fixed</div></div><!-- fragment --></p>
<p>The ratios of the planetary can be set using a simplified formula for the so called <em>Willis</em> case. Imagine we hold fixed the carrier (shaft B in epic. reducers), and leave the truss C free (the outer gear with inner teeth in our reducer); which is the transmission ratio \( t_0 \) that we get. It is simply \( t_0=-Z_a/Z_c \), with \( Z_i \) = num of teeth of gears. Use the following to set all the three ratios:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        // the transmission ratio t0 that we get? It is simply t0=-Za/Zc, with Z = num of teeth of gears.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        // So just use the following to set all the three ratios automatically:</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        double t0 =</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;            -50.0 / 100.0;  // suppose, in the reducer, that pinion A has 50 teeth and truss has 100 inner teeth.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        my_shaft_planetaryBAC-&gt;SetTransmissionRatioOrdinary(t0);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        my_system.Add(my_shaft_planetaryBAC);</div></div><!-- fragment --></p>
<p>Now, let's make a shaft D that is fixed and thus used for the right side of a clutch (so the clutch will act as a brake).</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftD = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftD-&gt;SetShaftFixed(true);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftD);</div></div><!-- fragment --></p>
<p>Next, make the brake. It is, in fact, a clutch between shafts B and D, where D is fixed as a truss so that the clutch will operate as a brake.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaft_clutchBD = std::make_shared&lt;ChShaftsClutch&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaft_clutchBD-&gt;Initialize(my_shaftB, my_shaftD);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaft_clutchBD-&gt;SetTorqueLimit(60);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaft_clutchBD);</div></div><!-- fragment --></p>
<h2>Example 4: constraint between a ChBody and a ChShaft</h2>
<p>Suppose we want to create a 3D model, for instance a slider-crank, built with multiple ChBody objects. Moreover, we want to create a powertrain, for instance a motor, a clutch, etc., for the rotation of the crank. Connecting <em>1D items</em> of ChShaft class with the <em>3D items</em> of ChBody class calls for the use of a ChShaftsBody constraint, shown as <code>[ bs ]</code> in the schematic in which the 3D body is shown as <code>&lt;&gt;</code>. This example also considers a 'torsional spring damper' <code>C</code>, shown as <code>[ t ]</code>, that connects shafts <code>A</code> and <code>C</code> (C is shown as <code>*</code> because fixed). </p><div class="fragment"><div class="line">      B             A           C</div><div class="line">Ta   &lt;&gt;---[ bs ]---||---[ t ]---*</div></div><!-- fragment --><p>First, create 'A', a 1D shaft:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftA-&gt;SetInertia(9);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftA);</div></div><!-- fragment --></p>
<p>Next, create 'C', a 1D shaft, fixed:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftC = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftC-&gt;SetShaftFixed(true);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftC);</div></div><!-- fragment --></p>
<p>Create 'B', a 3D rigid body:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_bodyB = std::make_shared&lt;ChBody&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_bodyB-&gt;Accumulate_torque(ChVector&lt;&gt;(0, 0, 3), true);  // set some constant torque to body</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_bodyB);</div></div><!-- fragment --></p>
<p>Define the torsional spring-damper between shafts A and C:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaft_torsionAC = std::make_shared&lt;ChShaftsTorsionSpring&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaft_torsionAC-&gt;Initialize(my_shaftA, my_shaftC);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaft_torsionAC-&gt;SetTorsionalStiffness(40);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_shaft_torsionAC-&gt;SetTorsionalDamping(0);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        my_system.Add(my_shaft_torsionAC);</div></div><!-- fragment --></p>
<p>Define the shaft 'A' connected to the rotation of the 3D body 'B'. Finally, specify the direction (in body coordinates) along which the shaft will affect the body:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftbody_connection = std::make_shared&lt;ChShaftsBody&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        ChVector&lt;&gt; mshaftdir(VECT_Z);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftbody_connection-&gt;Initialize(my_shaftA, my_bodyB, mshaftdir);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftbody_connection);</div></div><!-- fragment --></p>
<h2>Example 5: torque converter and thermal engine</h2>
<p>This example highlights the use of a torque converter. The torque converter is represented by a ChShaftsTorqueConverter object that connects three 1D items of ChShaft class:</p><ul>
<li>the input shaft A, i.e., the impeller connected to the engine</li>
<li>the output shaft B, i.e., the turbine connected to the gears and wheels</li>
<li>the stator C, which does not rotate and transmits reaction to the truss In the following schematic, the torque converter is represented as <code>[ tc ]</code>, the thermal engine is marked with <code>[ e ]</code>, and the breaking torque is <code>Tb</code> (C shown as <code>*</code> since fixed).</li>
</ul>
<p>First, create 'A', a 1D shaft:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftA-&gt;SetInertia(1.5);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftA);</div></div><!-- fragment --></p>
<p>Next, create 'B', a 1D shaft:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftB-&gt;SetInertia(3.2);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_shaftB-&gt;SetAppliedTorque(-5);  // apply const braking torque</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_shaftB);</div></div><!-- fragment --></p>
<p>Create 'C', a 1D shaft, fixed:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftC = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftC-&gt;SetShaftFixed(true);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftC);</div></div><!-- fragment --></p>
<p>Create 'D', a 1D shaft, fixed:</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_shaftD = std::make_shared&lt;ChShaft&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_shaftD-&gt;SetShaftFixed(true);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_shaftD);</div></div><!-- fragment --></p>
<p>Define the torque converter and connect the shafts: A (input), B (output), C(truss stator)</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_torqueconverter = std::make_shared&lt;ChShaftsTorqueConverter&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_torqueconverter-&gt;Initialize(my_shaftA, my_shaftB, my_shaftC);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_torqueconverter);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        auto mK = std::make_shared&lt;ChFunction_Recorder&gt;();</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        mK-&gt;AddPoint(0.0, 15);</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        mK-&gt;AddPoint(0.25, 15);</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        mK-&gt;AddPoint(0.50, 15);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        mK-&gt;AddPoint(0.75, 16);</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        mK-&gt;AddPoint(0.90, 18);</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        mK-&gt;AddPoint(1.00, 35);</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        my_torqueconverter-&gt;SetCurveCapacityFactor(mK);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        auto mT = std::make_shared&lt;ChFunction_Recorder&gt;();</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        mT-&gt;AddPoint(0.0, 2.00);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        mT-&gt;AddPoint(0.25, 1.80);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        mT-&gt;AddPoint(0.50, 1.50);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        mT-&gt;AddPoint(0.75, 1.15);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        mT-&gt;AddPoint(1.00, 1.00);</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        my_torqueconverter-&gt;SetCurveTorqueRatio(mT);</div></div><!-- fragment --></p>
<p>Define the thermal engine acting on shaft A, the input to the torque converter. Note that the thermal engine also requires shaft D, which is used to transmit the reaction torque back to a truss (the motor block).</p>
<p><b>Option A</b>: use a ChShaftsMotor in MOT_MODE_TORQUE mode. It works, but most often this is more useful when in MOT_MODE_SPEED.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_motor = std::make_shared&lt;ChShaftsMotor&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_motor-&gt;Initialize(my_shaftA, my_shaftD);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_motor-&gt;SetMotorMode(ChShaftsMotor::MOT_MODE_TORQUE);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_motor-&gt;SetMotorTorque(30);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        my_system.Add(my_motor);</div></div><!-- fragment --></p>
<p><b>Option B</b>: use a ChShaftsTorque - it simply applies a torque to my_shaftA (say, the crankshaft), and the negative torque to my_shaftD (say, the motor block). It is a quick approach. Note that the torque should be changed at each timestep if a torque curve is to be emulated.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_motor = std::make_shared&lt;ChShaftsTorque&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_motor-&gt;Initialize(my_shaftA, my_shaftD);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_motor-&gt;SetTorque(30);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        my_system.Add(my_motor);</div></div><!-- fragment --></p>
<p><b>Option C</b>: a more versatile approach where one can define a torque curve and a throttle value via the ChShaftsThermalEngine.</p>
<p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        auto my_motor = std::make_shared&lt;ChShaftsThermalEngine&gt;();</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        my_motor-&gt;Initialize(my_shaftA, my_shaftD);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        my_system.Add(my_motor);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        auto mTw = std::make_shared&lt;ChFunction_Recorder&gt;();</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        mTw-&gt;AddPoint(-5, 30);  //   [rad/s],  [Nm]</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        mTw-&gt;AddPoint(0, 30);</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        mTw-&gt;AddPoint(200, 60);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        mTw-&gt;AddPoint(400, 40);</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        mTw-&gt;AddPoint(450, 0);</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        mTw-&gt;AddPoint(500, -60);  // torque curve must be defined beyond max speed too - engine might be &#39;pulled&#39;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        my_motor-&gt;SetTorqueCurve(mTw);</div></div><!-- fragment --></p>
<h2>The complete listing:</h2>
<div class="fragment"><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// PROJECT CHRONO - http://projectchrono.org</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Copyright (c) 2010 Alessandro Tasora</span></div><div class="line"><span class="comment">// All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div><div class="line"><span class="comment">// found in the LICENSE file at the top level of the distribution</span></div><div class="line"><span class="comment">// and at http://projectchrono.org/license-chrono.txt.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   Demo code about</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     - creating a power train using the &#39;1D&#39;</span></div><div class="line"><span class="comment">//       items of ChShaft class (rotating parts</span></div><div class="line"><span class="comment">//       that have only one degree of freedom and</span></div><div class="line"><span class="comment">//       one inertia value). This is an easier</span></div><div class="line"><span class="comment">//       alternative to creating full 3D ChBody</span></div><div class="line"><span class="comment">//       objects that rotate on revolute joints, etc.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       CHRONO</span></div><div class="line"><span class="comment">//   ------</span></div><div class="line"><span class="comment">//   Multibody dinamics engine</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment">//             http://www.projectchrono.org</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChSystem.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsGear.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsClutch.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsPlanetary.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsBody.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsTorsionSpring.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsTorqueConverter.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsMotor.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsTorque.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChShaftsThermalEngine.h&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono.html">chrono</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// EXAMPLE 1:</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot; Example: create a simple power train with ChShaft objects: \n&quot;</span>;</div><div class="line"></div><div class="line">        <span class="comment">// We will model a very basic powertrain with two shafts A and B,</span></div><div class="line">        <span class="comment">// connected by a reducer [ t ] with transmision ratio &#39;t&#39;. Shafts are</span></div><div class="line">        <span class="comment">// free to rotate, shaft A has an applied torque Ta, so A and B will</span></div><div class="line">        <span class="comment">// constantly accelerate. Each shaft must have some inertia, it&#39;s like a</span></div><div class="line">        <span class="comment">// flywheel, marked as || in the following scheme:</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">//       A           B</span></div><div class="line">        <span class="comment">//  Ta  ||---[ t ]---||</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">// The physical system: it contains all physical objects.</span></div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">        <span class="comment">// Create a 1-degree-of-freedom &#39;1D&#39; mechanical object, that</span></div><div class="line">        <span class="comment">// is a ChShaft (an item that can oly rotate, with one inertia value</span></div><div class="line">        <span class="comment">// and maybe one applied torque). The ChShaft objects do not have</span></div><div class="line">        <span class="comment">// any meaning in 3d: they are just &#39;building blocks&#39; for making</span></div><div class="line">        <span class="comment">// power trains as in imput-output black box schemes.</span></div><div class="line">        <span class="keyword">auto</span> my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftA-&gt;SetInertia(10);</div><div class="line">        my_shaftA-&gt;SetAppliedTorque(6);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftA);</div><div class="line"></div><div class="line">        <span class="comment">// Create another shaft. Note that we use shared pointers for ChShaft</span></div><div class="line">        <span class="comment">// objects, as we did for ChBody objects. Also, note that we must add them</span></div><div class="line">        <span class="comment">// to the ChSystem.</span></div><div class="line">        <span class="keyword">auto</span> my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftB-&gt;SetInertia(100);</div><div class="line">        my_shaftB-&gt;SetShaftFixed(<span class="keyword">false</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftB);</div><div class="line"></div><div class="line">        <span class="comment">// Create a ChShaftsGear, that represents a simplified model</span></div><div class="line">        <span class="comment">// of a reducer, with transmission ratio t, between two ChShaft objects.</span></div><div class="line">        <span class="comment">// (Note that you could also build a 3D powertrain by creating full rigid bodies</span></div><div class="line">        <span class="comment">// of ChBody type and join them using ChLinkLockRevolute, ChLinkGear 3D constraints,</span></div><div class="line">        <span class="comment">// but this would introduce many unnecessary degrees of freedom/constraints</span></div><div class="line">        <span class="comment">// whereas the 1D items of ChShaft type, in this example, make things much simplier).</span></div><div class="line">        <span class="keyword">auto</span> my_shaft_gearAB = std::make_shared&lt;ChShaftsGear&gt;();</div><div class="line">        my_shaft_gearAB-&gt;Initialize(my_shaftA, my_shaftB);</div><div class="line">        my_shaft_gearAB-&gt;SetTransmissionRatio(-0.1);  <span class="comment">// ex., a couple of spur gears with 20 and 200 teeth</span></div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaft_gearAB);</div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;\n\n\nHere&#39;s the system hierarchy: \n\n &quot;</span>;</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aa0dd1bd157d6ff3dcaa46b0da6f5e87e">ShowHierarchy</a>(<a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>());</div><div class="line"></div><div class="line">        <span class="comment">// Perform a very simple simulation loop..</span></div><div class="line">        <span class="keywordtype">double</span> chronoTime = 0;</div><div class="line">        <span class="keywordflow">while</span> (chronoTime &lt; 2.5) {</div><div class="line">            chronoTime += 0.01;</div><div class="line"></div><div class="line">            <span class="comment">// PERFORM SIMULATION UP TO chronoTime</span></div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0f24e4932e6c9afda09c0404e1626157">DoFrameDynamics</a>(chronoTime);</div><div class="line"></div><div class="line">            <span class="comment">// Print something on the console..</span></div><div class="line"></div><div class="line">            <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Time: &quot;</span> &lt;&lt; chronoTime &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft A rot: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft B  rot: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  AB gear, torque on A side: &quot;</span> &lt;&lt; my_shaft_gearAB-&gt;GetTorqueReactionOn1()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  AB gear, torque on B side: &quot;</span> &lt;&lt; my_shaft_gearAB-&gt;GetTorqueReactionOn2() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// EXAMPLE 2:</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot; Example: a clutch between two shafts \n&quot;</span>;</div><div class="line"></div><div class="line">        <span class="comment">// We will model a very basic powertrain with two shafts A and B,</span></div><div class="line">        <span class="comment">// connected by a clutch [ c ]. Shafts (see flywheels || in scheme)</span></div><div class="line">        <span class="comment">// starts with nonzero speed, and are free to rotate independently</span></div><div class="line">        <span class="comment">// until the clutch is activated: since activation, they will decelerate</span></div><div class="line">        <span class="comment">// until they have the same speed.</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">//       A           B</span></div><div class="line">        <span class="comment">//  Ta  ||---[ c ]---||</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">// The physical system: it contains all physical objects.</span></div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">        <span class="comment">// Create a ChShaft that starts with nonzero angular velocity</span></div><div class="line">        <span class="keyword">auto</span> my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftA-&gt;SetInertia(0.5);</div><div class="line">        my_shaftA-&gt;SetPos_dt(30);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftA);</div><div class="line"></div><div class="line">        <span class="comment">// Create another ChShaft, with opposite initial angular velocity</span></div><div class="line">        <span class="keyword">auto</span> my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftB-&gt;SetInertia(0.6);</div><div class="line">        my_shaftB-&gt;SetPos_dt(-10);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftB);</div><div class="line"></div><div class="line">        <span class="comment">// Create a ChShaftsClutch, that represents a simplified model</span></div><div class="line">        <span class="comment">// of a clutch between two ChShaft objects (something that limits</span></div><div class="line">        <span class="comment">// the max transmitted torque, up to slippage).</span></div><div class="line">        <span class="keyword">auto</span> my_shaft_clutchAB = std::make_shared&lt;ChShaftsClutch&gt;();</div><div class="line">        my_shaft_clutchAB-&gt;Initialize(my_shaftA, my_shaftB);</div><div class="line">        my_shaft_clutchAB-&gt;SetTorqueLimit(60);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaft_clutchAB);</div><div class="line"></div><div class="line">        <span class="comment">// Let&#39;s begin the simulation with the clutch disengaged:</span></div><div class="line">        my_shaft_clutchAB-&gt;SetModulation(0);</div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;\n\n\nHere&#39;s the system hierarchy: \n\n &quot;</span>;</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aa0dd1bd157d6ff3dcaa46b0da6f5e87e">ShowHierarchy</a>(<a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>());</div><div class="line"></div><div class="line">        <span class="comment">// Perform a very simple simulation loop..</span></div><div class="line">        <span class="keywordtype">double</span> chronoTime = 0;</div><div class="line">        <span class="keywordflow">while</span> (chronoTime &lt; 1.5) {</div><div class="line">            chronoTime += 0.01;</div><div class="line"></div><div class="line">            <span class="comment">// PERFORM SIMULATION UP TO chronoTime</span></div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0f24e4932e6c9afda09c0404e1626157">DoFrameDynamics</a>(chronoTime);</div><div class="line"></div><div class="line">            <span class="comment">// Activate the clutch only after 0.8 seconds of simulation:</span></div><div class="line">            <span class="keywordflow">if</span> (chronoTime &gt; 0.8) {</div><div class="line">                my_shaft_clutchAB-&gt;SetModulation(1);</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// Print something on the console..</span></div><div class="line">            <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Time: &quot;</span> &lt;&lt; chronoTime &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft A rot: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft B  rot: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  AB clutch, torque on A side: &quot;</span> &lt;&lt; my_shaft_clutchAB-&gt;GetTorqueReactionOn1()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  AB clutch, torque on B side: &quot;</span> &lt;&lt; my_shaft_clutchAB-&gt;GetTorqueReactionOn2() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// EXAMPLE 3:</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot; Example: an epicycloidal reducer \n&quot;</span>;</div><div class="line"></div><div class="line">        <span class="comment">// We will model an epicycloidal reducer using the ChShaftsPlanetary</span></div><div class="line">        <span class="comment">// constraint.</span></div><div class="line">        <span class="comment">// The ChShaftsPlanetary makes a kinematic constraint between three</span></div><div class="line">        <span class="comment">// shafts: so one of them will be &#39;fixed&#39; and will represent the truss</span></div><div class="line">        <span class="comment">// of the reducer -in epicycloidaal reducer, this is the role of the</span></div><div class="line">        <span class="comment">// large gear with inner teeth- and the two remaining shafts are the</span></div><div class="line">        <span class="comment">// input and output shafts (in other cases, such as the differential</span></div><div class="line">        <span class="comment">// planetary gear of the cars, all three shafts are free).</span></div><div class="line">        <span class="comment">// Also, a brake is applied for the output shaft: the ChShaftsClutch</span></div><div class="line">        <span class="comment">// will be used to this end, it&#39;s enough that one of the two shafts is fixed.</span></div><div class="line">        <span class="comment">// In the following scheme, the brake is [ b ], the planetary (the</span></div><div class="line">        <span class="comment">// reducer) is [ p ], the shafts are A,B,C,D applied torque is Ta, inertias</span></div><div class="line">        <span class="comment">// of free shafts are shown as flywheels || , and fixed shafts are marked with * .</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">//       A           B            D</span></div><div class="line">        <span class="comment">//  Ta  ||---[ p ]---||---[ b ]---*</span></div><div class="line">        <span class="comment">//           [   ]---*</span></div><div class="line">        <span class="comment">//                   C</span></div><div class="line"></div><div class="line">        <span class="comment">// The physical system: it contains all physical objects.</span></div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">        <span class="comment">// Create shaft A, with applied torque</span></div><div class="line">        <span class="keyword">auto</span> my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftA-&gt;SetInertia(0.5);</div><div class="line">        my_shaftA-&gt;SetAppliedTorque(10);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftA);</div><div class="line"></div><div class="line">        <span class="comment">// Create shaft B</span></div><div class="line">        <span class="keyword">auto</span> my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftB-&gt;SetInertia(0.5);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftB);</div><div class="line"></div><div class="line">        <span class="comment">// Create shaft C, that will be fixed (to be used as truss of epicycloidal reducer)</span></div><div class="line">        <span class="keyword">auto</span> my_shaftC = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftC-&gt;SetShaftFixed(<span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftC);</div><div class="line"></div><div class="line">        <span class="comment">// Create a ChShaftsPlanetary, that represents a simplified model</span></div><div class="line">        <span class="comment">// of a planetary gear between THREE ChShaft objects (ex.: a car differential)</span></div><div class="line">        <span class="comment">// An epicycloidal reducer is a special type of planetary gear.</span></div><div class="line">        <span class="keyword">auto</span> my_shaft_planetaryBAC = std::make_shared&lt;ChShaftsPlanetary&gt;();</div><div class="line">        my_shaft_planetaryBAC-&gt;Initialize(my_shaftB, my_shaftA, my_shaftC);  <span class="comment">// output, carrier, fixed</span></div><div class="line">        <span class="comment">// We can set the ratios of the planetary using a simplified formula, for the</span></div><div class="line">        <span class="comment">// so called &#39;Willis&#39; case. Imagine we hold fixed the carrier (shaft B in epic. reducers),</span></div><div class="line">        <span class="comment">// and leave free the truss C (the outer gear with inner teeth in our reducer); which is</span></div><div class="line">        <span class="comment">// the transmission ratio t0 that we get? It is simply t0=-Za/Zc, with Z = num of teeth of gears.</span></div><div class="line">        <span class="comment">// So just use the following to set all the three ratios automatically:</span></div><div class="line">        <span class="keywordtype">double</span> t0 =</div><div class="line">            -50.0 / 100.0;  <span class="comment">// suppose, in the reducer, that pinion A has 50 teeth and truss has 100 inner teeth.</span></div><div class="line">        my_shaft_planetaryBAC-&gt;SetTransmissionRatioOrdinary(t0);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaft_planetaryBAC);</div><div class="line"></div><div class="line">        <span class="comment">// Now, let&#39;s make a shaft D, that is fixed, and used for the right side</span></div><div class="line">        <span class="comment">// of a clutch (so the clutch will act as a brake).</span></div><div class="line">        <span class="keyword">auto</span> my_shaftD = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftD-&gt;SetShaftFixed(<span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftD);</div><div class="line"></div><div class="line">        <span class="comment">// Make the brake. It is, in fact a clutch between shafts B and D, where</span></div><div class="line">        <span class="comment">// D is fixed as a truss, so the clutch will operate as a brake.</span></div><div class="line">        <span class="keyword">auto</span> my_shaft_clutchBD = std::make_shared&lt;ChShaftsClutch&gt;();</div><div class="line">        my_shaft_clutchBD-&gt;Initialize(my_shaftB, my_shaftD);</div><div class="line">        my_shaft_clutchBD-&gt;SetTorqueLimit(60);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaft_clutchBD);</div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;\n\n\nHere&#39;s the system hierarchy: \n\n &quot;</span>;</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aa0dd1bd157d6ff3dcaa46b0da6f5e87e">ShowHierarchy</a>(<a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>());</div><div class="line"></div><div class="line">        <span class="comment">// Perform a very simple simulation loop..</span></div><div class="line">        <span class="keywordtype">double</span> chronoTime = 0;</div><div class="line">        <span class="keywordflow">while</span> (chronoTime &lt; 1.5) {</div><div class="line">            chronoTime += 0.01;</div><div class="line"></div><div class="line">            <span class="comment">// PERFORM SIMULATION UP TO chronoTime</span></div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0f24e4932e6c9afda09c0404e1626157">DoFrameDynamics</a>(chronoTime);</div><div class="line"></div><div class="line">            <span class="comment">// Print something on the console..</span></div><div class="line">            <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Time: &quot;</span> &lt;&lt; chronoTime &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft A rot: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft B  rot: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  epicycloidal react torques on shafts - on A: &quot;</span></div><div class="line">                     &lt;&lt; my_shaft_planetaryBAC-&gt;GetTorqueReactionOn2()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot; ,   on B: &quot;</span> &lt;&lt; my_shaft_planetaryBAC-&gt;GetTorqueReactionOn1()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot; ,   on C: &quot;</span> &lt;&lt; my_shaft_planetaryBAC-&gt;GetTorqueReactionOn3() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// EXAMPLE 4:</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot; Example: constraint between a ChBody and a ChShaft \n&quot;</span>;</div><div class="line"></div><div class="line">        <span class="comment">// Suppose you want to create a 3D model, for instance a slider-crank,</span></div><div class="line">        <span class="comment">// built with multiple ChBody objects; moreover you want to create a</span></div><div class="line">        <span class="comment">// powertrain, for instance a motor, a clutch, etc, for the rotation of</span></div><div class="line">        <span class="comment">// the crank. How to connect the &#39;1D items&#39; of ChShaft class to the 3D</span></div><div class="line">        <span class="comment">// items of ChBody class? The solution is to use the ChShaftsBody constraint,</span></div><div class="line">        <span class="comment">// shown as [ bs ] in the following scheme, where the 3D body is shown as &lt;&gt;.</span></div><div class="line">        <span class="comment">// In this example we also add a &#39;torsional spring damper&#39; C, shown as [ t ]</span></div><div class="line">        <span class="comment">// that connects shafts A and C (C is shown as * because fixed).</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">//        B             A           C</span></div><div class="line">        <span class="comment">//  Ta   &lt;&gt;---[ bs ]---||---[ t ]---*</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">// The physical system: it contains all physical objects.</span></div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;A&#39;, a 1D shaft</span></div><div class="line">        <span class="keyword">auto</span> my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftA-&gt;SetInertia(9);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftA);</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;C&#39;, a 1D shaft, fixed</span></div><div class="line">        <span class="keyword">auto</span> my_shaftC = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftC-&gt;SetShaftFixed(<span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftC);</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;B&#39;, a 3D rigid body</span></div><div class="line">        <span class="keyword">auto</span> my_bodyB = std::make_shared&lt;ChBody&gt;();</div><div class="line">        my_bodyB-&gt;Accumulate_torque(ChVector&lt;&gt;(0, 0, 3), <span class="keyword">true</span>);  <span class="comment">// set some constant torque to body</span></div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_bodyB);</div><div class="line"></div><div class="line">        <span class="comment">// Make the torsional spring-damper between shafts A and C.</span></div><div class="line">        <span class="keyword">auto</span> my_shaft_torsionAC = std::make_shared&lt;ChShaftsTorsionSpring&gt;();</div><div class="line">        my_shaft_torsionAC-&gt;Initialize(my_shaftA, my_shaftC);</div><div class="line">        my_shaft_torsionAC-&gt;SetTorsionalStiffness(40);</div><div class="line">        my_shaft_torsionAC-&gt;SetTorsionalDamping(0);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaft_torsionAC);</div><div class="line"></div><div class="line">        <span class="comment">// Make the shaft &#39;A&#39; connected to the rotation of the 3D body &#39;B&#39;.</span></div><div class="line">        <span class="comment">// We must specify the direction (in body coordinates) along which the</span></div><div class="line">        <span class="comment">// shaft will affect the body.</span></div><div class="line">        <span class="keyword">auto</span> my_shaftbody_connection = std::make_shared&lt;ChShaftsBody&gt;();</div><div class="line">        ChVector&lt;&gt; mshaftdir(VECT_Z);</div><div class="line">        my_shaftbody_connection-&gt;Initialize(my_shaftA, my_bodyB, mshaftdir);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftbody_connection);</div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;\n\n\nHere&#39;s the system hierarchy: \n\n &quot;</span>;</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aa0dd1bd157d6ff3dcaa46b0da6f5e87e">ShowHierarchy</a>(<a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>());</div><div class="line"></div><div class="line">        <span class="comment">// Perform a very simple simulation loop..</span></div><div class="line">        <span class="keywordtype">double</span> chronoTime = 0;</div><div class="line">        <span class="keywordflow">while</span> (chronoTime &lt; 0.5) {</div><div class="line">            chronoTime += 0.01;</div><div class="line"></div><div class="line">            <span class="comment">// PERFORM SIMULATION UP TO chronoTime</span></div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0f24e4932e6c9afda09c0404e1626157">DoFrameDynamics</a>(chronoTime);</div><div class="line"></div><div class="line">            <span class="comment">// Print something on the console..</span></div><div class="line">            <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Time: &quot;</span> &lt;&lt; chronoTime &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft A rot: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  Body B angular speed on z: &quot;</span> &lt;&lt; my_bodyB-&gt;GetWvel_loc().z</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel on z: &quot;</span> &lt;&lt; my_bodyB-&gt;GetWacc_loc().z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  AC spring, torque on A side: &quot;</span> &lt;&lt; my_shaft_torsionAC-&gt;GetTorqueReactionOn1()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  torque on C side: &quot;</span> &lt;&lt; my_shaft_torsionAC-&gt;GetTorqueReactionOn2() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shafts/body reaction,  on shaft A: &quot;</span> &lt;&lt; my_shaftbody_connection-&gt;GetTorqueReactionOnShaft()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot; ,   on body (x y z): &quot;</span> &lt;&lt; my_shaftbody_connection-&gt;GetTorqueReactionOnBody().x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line">                     &lt;&lt; my_shaftbody_connection-&gt;GetTorqueReactionOnBody().y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line">                     &lt;&lt; my_shaftbody_connection-&gt;GetTorqueReactionOnBody().z &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span>) {</div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// EXAMPLE 5:</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot; Example: torque converter and thermal engine \n&quot;</span>;</div><div class="line"></div><div class="line">        <span class="comment">// In this example we use a torque converter.</span></div><div class="line">        <span class="comment">// The torque converter is represented by a ChShaftsTorqueConverter</span></div><div class="line">        <span class="comment">// object, that connects three &#39;1D items&#39; of ChShaft class:</span></div><div class="line">        <span class="comment">// - the input shaft A, ie. the impeller connected to the engine</span></div><div class="line">        <span class="comment">// - the output shaft B, i.e. the turbine connected to the gears and wheels</span></div><div class="line">        <span class="comment">// - the stator C, that does not rotate and transmits reaction to the truss.</span></div><div class="line">        <span class="comment">// In the following scheme, the torque converter is represented as [ tc ],</span></div><div class="line">        <span class="comment">// and we also add a thermal engine, shown with [ e ], and a breaking torque Tb</span></div><div class="line">        <span class="comment">// (C is shown as * because fixed).</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">//   D           A             B</span></div><div class="line">        <span class="comment">//   *---[ e ]---||---[ tc ]---||  Tb</span></div><div class="line">        <span class="comment">//                    [    ]---*</span></div><div class="line">        <span class="comment">//                             C</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">// The physical system: it contains all physical objects.</span></div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;A&#39;, a 1D shaft</span></div><div class="line">        <span class="keyword">auto</span> my_shaftA = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftA-&gt;SetInertia(1.5);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftA);</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;B&#39;, a 1D shaft</span></div><div class="line">        <span class="keyword">auto</span> my_shaftB = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftB-&gt;SetInertia(3.2);</div><div class="line">        my_shaftB-&gt;SetAppliedTorque(-5);  <span class="comment">// apply const braking torque</span></div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftB);</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;C&#39;, a 1D shaft, fixed</span></div><div class="line">        <span class="keyword">auto</span> my_shaftC = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftC-&gt;SetShaftFixed(<span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftC);</div><div class="line"></div><div class="line">        <span class="comment">// Create &#39;D&#39;, a 1D shaft, fixed</span></div><div class="line">        <span class="keyword">auto</span> my_shaftD = std::make_shared&lt;ChShaft&gt;();</div><div class="line">        my_shaftD-&gt;SetShaftFixed(<span class="keyword">true</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_shaftD);</div><div class="line"></div><div class="line">        <span class="comment">// Make the torque converter and connect the shafts:</span></div><div class="line">        <span class="comment">// A (input),B (output), C(truss stator)</span></div><div class="line">        <span class="keyword">auto</span> my_torqueconverter = std::make_shared&lt;ChShaftsTorqueConverter&gt;();</div><div class="line">        my_torqueconverter-&gt;Initialize(my_shaftA, my_shaftB, my_shaftC);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_torqueconverter);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> mK = std::make_shared&lt;ChFunction_Recorder&gt;();</div><div class="line">        mK-&gt;AddPoint(0.0, 15);</div><div class="line">        mK-&gt;AddPoint(0.25, 15);</div><div class="line">        mK-&gt;AddPoint(0.50, 15);</div><div class="line">        mK-&gt;AddPoint(0.75, 16);</div><div class="line">        mK-&gt;AddPoint(0.90, 18);</div><div class="line">        mK-&gt;AddPoint(1.00, 35);</div><div class="line">        my_torqueconverter-&gt;SetCurveCapacityFactor(mK);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> mT = std::make_shared&lt;ChFunction_Recorder&gt;();</div><div class="line">        mT-&gt;AddPoint(0.0, 2.00);</div><div class="line">        mT-&gt;AddPoint(0.25, 1.80);</div><div class="line">        mT-&gt;AddPoint(0.50, 1.50);</div><div class="line">        mT-&gt;AddPoint(0.75, 1.15);</div><div class="line">        mT-&gt;AddPoint(1.00, 1.00);</div><div class="line">        my_torqueconverter-&gt;SetCurveTorqueRatio(mT);</div><div class="line"></div><div class="line">        <span class="comment">// Make the thermal engine, acting on shaft A, the input to</span></div><div class="line">        <span class="comment">// the torque converter. Note that the thermal engine also</span></div><div class="line">        <span class="comment">// requires another shaft D, that is used to transmit the</span></div><div class="line">        <span class="comment">// reaction torque back to a truss (the motor block).</span></div><div class="line"></div><div class="line">        <span class="comment">// Option A: use a ChShaftsMotor, in the MOT_MODE_TORQUE mode.</span></div><div class="line">        <span class="comment">//  It works, but most often this is more useful when in MOT_MODE_SPEED.</span></div><div class="line">        <span class="comment">/*</span></div><div class="line"><span class="comment">        auto my_motor = std::make_shared&lt;ChShaftsMotor&gt;();</span></div><div class="line"><span class="comment">        my_motor-&gt;Initialize(my_shaftA, my_shaftD);</span></div><div class="line"><span class="comment">        my_motor-&gt;SetMotorMode(ChShaftsMotor::MOT_MODE_TORQUE);</span></div><div class="line"><span class="comment">        my_motor-&gt;SetMotorTorque(30);</span></div><div class="line"><span class="comment">        my_system.Add(my_motor);</span></div><div class="line"><span class="comment">        */</span></div><div class="line"></div><div class="line">        <span class="comment">// Option B: use a ChShaftsTorque, it just applies a torque</span></div><div class="line">        <span class="comment">// to my_shaftA (say, the crankshaft) and the negative torque</span></div><div class="line">        <span class="comment">// to my_shaftD (say, the motor block).</span></div><div class="line">        <span class="comment">// It is a quick approach. But you should take care of changing</span></div><div class="line">        <span class="comment">// the torque at each timestep if you want to simulate a torque curve...</span></div><div class="line">        <span class="comment">/*</span></div><div class="line"><span class="comment">        auto my_motor = std::make_shared&lt;ChShaftsTorque&gt;();</span></div><div class="line"><span class="comment">        my_motor-&gt;Initialize(my_shaftA, my_shaftD);</span></div><div class="line"><span class="comment">        my_motor-&gt;SetTorque(30);</span></div><div class="line"><span class="comment">        my_system.Add(my_motor);</span></div><div class="line"><span class="comment">        */</span></div><div class="line"></div><div class="line">        <span class="comment">// Option C: a more powerful approach where you can</span></div><div class="line">        <span class="comment">// define a torque curve and a throttle value, using the</span></div><div class="line">        <span class="comment">// ChShaftsThermalEngine.</span></div><div class="line"></div><div class="line">        <span class="keyword">auto</span> my_motor = std::make_shared&lt;ChShaftsThermalEngine&gt;();</div><div class="line">        my_motor-&gt;Initialize(my_shaftA, my_shaftD);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(my_motor);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> mTw = std::make_shared&lt;ChFunction_Recorder&gt;();</div><div class="line">        mTw-&gt;AddPoint(-5, 30);  <span class="comment">//   [rad/s],  [Nm]</span></div><div class="line">        mTw-&gt;AddPoint(0, 30);</div><div class="line">        mTw-&gt;AddPoint(200, 60);</div><div class="line">        mTw-&gt;AddPoint(400, 40);</div><div class="line">        mTw-&gt;AddPoint(450, 0);</div><div class="line">        mTw-&gt;AddPoint(500, -60);  <span class="comment">// torque curve must be defined beyond max speed too - engine might be &#39;pulled&#39;</span></div><div class="line">        my_motor-&gt;SetTorqueCurve(mTw);</div><div class="line"></div><div class="line">        <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;\n\n\nHere&#39;s the system hierarchy: \n\n &quot;</span>;</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aa0dd1bd157d6ff3dcaa46b0da6f5e87e">ShowHierarchy</a>(<a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>());</div><div class="line"></div><div class="line">        <span class="comment">// Perform a very simple simulation loop..</span></div><div class="line">        <span class="keywordtype">double</span> chronoTime = 0;</div><div class="line">        <span class="keywordflow">while</span> (chronoTime &lt; 4.5) {</div><div class="line">            chronoTime += 0.01;</div><div class="line"></div><div class="line">            <span class="comment">// PERFORM SIMULATION UP TO chronoTime</span></div><div class="line">            my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0f24e4932e6c9afda09c0404e1626157">DoFrameDynamics</a>(chronoTime);</div><div class="line"></div><div class="line">            <span class="comment">// Print something on the console..</span></div><div class="line">            <a class="code" href="namespacechrono.html#a4fba60cf9a29db628ad96a88b60b4e00">GetLog</a>() &lt;&lt; <span class="stringliteral">&quot;Time: &quot;</span> &lt;&lt; chronoTime &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft A rot: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftA-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  shaft B rot: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos() &lt;&lt; <span class="stringliteral">&quot;  speed: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dt()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  accel: &quot;</span> &lt;&lt; my_shaftB-&gt;GetPos_dtdt() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  T.Convert.:&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  R=&quot;</span> &lt;&lt; my_torqueconverter-&gt;GetSpeedRatio()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  Tin=&quot;</span> &lt;&lt; my_torqueconverter-&gt;GetTorqueReactionOnInput()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  Tout=&quot;</span> &lt;&lt; my_torqueconverter-&gt;GetTorqueReactionOnOutput()</div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  Tstator=&quot;</span> &lt;&lt; my_torqueconverter-&gt;GetTorqueReactionOnStator() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  T.Motor: &quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  T(w)=&quot;</span> &lt;&lt; my_motor-&gt;GetTorqueReactionOn1() &lt;&lt; <span class="stringliteral">&quot;[Nm]&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;  w=&quot;</span> &lt;&lt; my_motor-&gt;GetRelativeRotation_dt() &lt;&lt; <span class="stringliteral">&quot;[rad/s]&quot;</span></div><div class="line">                     &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 1 2016 15:43:10 for Project Chrono by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11 . <a href="mailto:info@projectchrono.org">Contact us</a> for issues related to this page. 
</small></address>
</body>
</html>
