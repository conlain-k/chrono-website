<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>Project Chrono: Basic suspensions example (demo_suspension.cpp)</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://projectchrono.org">
            <span class="logo first">PROJECT</span><span class="logo second">CHRONO</span>
        </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://projectchrono.org/download">Download</a></li>
        <li class="dropdown">
            <a href="http://api.chrono.projectchrono.org" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://api.chrono.projectchrono.org/faq_root.html">FAQ</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_table_of_content_install.html">Install Guide</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_root.html">Examples/Tutorials</a></li>
                <li><a href="http://api.chrono.projectchrono.org/model_root.html">Model Library</a></li>
                <li><a href="http://api.chrono.projectchrono.org/validation_studies_root.html">Validation Studies</a></li>
                <li><a href="http://api.chrono.projectchrono.org/whitepaper_root.html">White Papers</a></li>
                <li><a href="http://projectchrono.org/docpdf">PDF Version</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="http://projectchrono.org/gallery/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" style="dropdown:hover" aria-haspopup="true" aria-expanded="false">Movies <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/gallery/">Gallery</a></li>
                <li><a href="http://sbel.wisc.edu/Animations/">SBEL</a></li>
                <li><a href="https://vimeo.com/uwsbel">On Vimeo</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/news/">News</a></li>
        <li><a href="http://projectchrono.org/forum">Forum</a></li>
		<li class="dropdown">
            <a href="http://projectchrono.org/about/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/about/">What is ProjectChrono</a></li>
                <li><a href="http://projectchrono.org/testimonials/">Users</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/status">Status</a></li>            
            <li>
              <form method="get" action="http://projectchrono.org/search" id="search_bar_triggered">
                          <input type="submit" value="Search">
                <input type="text" id="search_bar" name="query" value="" />
              </form> 
            </li>
    </ul>
          <!-- <ul class="nav navbar-nav navbar-right">
      </ul> -->
  </div><!--/.navbar-collapse -->
</div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Project Chrono API/SDK documentation</a></li><li class="navelem"><a class="el" href="manual_root.html">Reference Manual</a></li><li class="navelem"><a class="el" href="tutorial_root.html">Tutorials</a></li><li class="navelem"><a class="el" href="tutorial_table_of_content_chrono_irrlicht.html">Chrono IRRLICHT module tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Basic suspensions example (demo_suspension.cpp) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Simulate a simplified vehicle with double-wishbone suspensions (like racing cars) and drive it using the mouse over some sliders in the interface.</p>
<p>This tutorial shows how to:</p>
<ul>
<li>use the ChLinkDistance to represent massless rods, saving computational efforts.</li>
<li>change the friction coefficient depending on the contact zone (here, half of the ground plane has lower friction).</li>
<li>use the Irrlicht interface system to interact with a model.</li>
<li>use ChLinkSpring to make spring-dampers</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// PROJECT CHRONO - http://projectchrono.org</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Copyright (c) 2010-2011 Alessandro Tasora</span></div><div class="line"><span class="comment">// All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div><div class="line"><span class="comment">// found in the LICENSE file at the top level of the distribution</span></div><div class="line"><span class="comment">// and at http://projectchrono.org/license-chrono.txt.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   Demo code about</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     - modeling a complex mechanism (a quarter car model)</span></div><div class="line"><span class="comment">//     - using the ChLinkSpring to make spring-damper system</span></div><div class="line"><span class="comment">//     - using the ChLinkDistance class to reperesent</span></div><div class="line"><span class="comment">//       long and thin massless rods, whose mass is negligible</span></div><div class="line"><span class="comment">//       for dynamical analysis (as often happens in mechanisms)</span></div><div class="line"><span class="comment">//       so they can be modeled as &#39;distance&#39; constraints</span></div><div class="line"><span class="comment">//       instead of making a thin body with small mass and two</span></div><div class="line"><span class="comment">//       spherical joints at the end (wihch would be much less</span></div><div class="line"><span class="comment">//       efficient from the computational point of view).</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;chrono/core/ChRealtimeStep.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChSystem.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChLinkDistance.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChBodyEasy.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChIrrApp.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// Use the namespaces of Chrono</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono.html">chrono</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono_1_1irrlicht.html">chrono::irrlicht</a>;</div><div class="line"></div><div class="line"><span class="comment">// Use the main namespaces of Irrlicht</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr.html">irr</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1core.html">irr::core</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1scene.html">irr::scene</a>;</div><div class="line"><span class="keyword">using namespace </span>irr::video;</div><div class="line"><span class="keyword">using namespace </span>irr::io;</div><div class="line"><span class="keyword">using namespace </span>irr::gui;</div><div class="line"></div><div class="line"><span class="comment">// First of all, define a class for the &#39;car&#39; (that is, a set of</span></div><div class="line"><span class="comment">// bodies and links which are grouped within this class; so it is</span></div><div class="line"><span class="comment">// easier to manage data structures in this example).</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MySimpleCar {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    <span class="comment">// THE DATA</span></div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> throttle;          <span class="comment">// actual value 0...1 of gas throttle.</span></div><div class="line">    <span class="keywordtype">double</span> conic_tau;         <span class="comment">// the transmission ratio of the conic gears at the rear axle</span></div><div class="line">    <span class="keywordtype">double</span> gear_tau;          <span class="comment">// the actual tau of the gear</span></div><div class="line">    <span class="keywordtype">double</span> max_motor_torque;  <span class="comment">// the max torque of the motor [Nm];</span></div><div class="line">    <span class="keywordtype">double</span> max_motor_speed;   <span class="comment">// the max rotation speed of the motor [rads/s]</span></div><div class="line"></div><div class="line">    <span class="comment">// .. chassis:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; chassis;</div><div class="line">    <span class="comment">// .. right front suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; spindleRF;</div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelRF;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteRF;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRFU1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRFU2;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRFL1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRFL2;</div><div class="line">    std::shared_ptr&lt;ChLinkSpring&gt; link_springRF;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRSTEER;</div><div class="line">    <span class="comment">// .. left front suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; spindleLF;</div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelLF;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteLF;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLFU1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLFU2;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLFL1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLFL2;</div><div class="line">    std::shared_ptr&lt;ChLinkSpring&gt; link_springLF;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLSTEER;</div><div class="line">    <span class="comment">// .. right back suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; spindleRB;</div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelRB;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteRB;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRBU1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRBU2;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRBL1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRBL2;</div><div class="line">    std::shared_ptr&lt;ChLinkSpring&gt; link_springRB;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distRBlat;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_engineL;</div><div class="line">    <span class="comment">// .. left back suspension:</span></div><div class="line">    std::shared_ptr&lt;ChBody&gt; spindleLB;</div><div class="line">    std::shared_ptr&lt;ChBody&gt; wheelLB;</div><div class="line">    std::shared_ptr&lt;ChLinkLockRevolute&gt; link_revoluteLB;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLBU1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLBU2;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLBL1;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLBL2;</div><div class="line">    std::shared_ptr&lt;ChLinkSpring&gt; link_springLB;</div><div class="line">    std::shared_ptr&lt;ChLinkDistance&gt; link_distLBlat;</div><div class="line">    std::shared_ptr&lt;ChLinkEngine&gt; link_engineR;</div><div class="line"></div><div class="line">    <span class="comment">// THE FUNCTIONS</span></div><div class="line"></div><div class="line">    <span class="comment">// Build and initialize the car, creating all bodies corresponding to</span></div><div class="line">    <span class="comment">// the various parts and adding them to the physical system - also creating</span></div><div class="line">    <span class="comment">// and adding constraints to the system.</span></div><div class="line">    MySimpleCar(<a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>&amp; my_system,           </div><div class="line">                ISceneManager* msceneManager,  </div><div class="line">                IVideoDriver* mdriver          </div><div class="line">                ) {</div><div class="line">        throttle = 0;  <span class="comment">// initially, gas throttle is 0.</span></div><div class="line">        conic_tau = 0.2;</div><div class="line">        gear_tau = 0.3;</div><div class="line">        max_motor_torque = 80;</div><div class="line">        max_motor_speed = 800;</div><div class="line"></div><div class="line">        <span class="comment">// Texture for wheels</span></div><div class="line">        <span class="keyword">auto</span> texture = std::make_shared&lt;ChTexture&gt;();</div><div class="line">        texture-&gt;SetTextureFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;bluwhite.png&quot;</span>));</div><div class="line"></div><div class="line">        <span class="comment">// --- The car body ---</span></div><div class="line">        chassis = std::make_shared&lt;ChBodyEasyBox&gt;(1, 0.5, 3, 1.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        chassis-&gt;SetPos(ChVector&lt;&gt;(0, 1, 0));</div><div class="line">        chassis-&gt;SetMass(150);</div><div class="line">        chassis-&gt;SetInertiaXX(ChVector&lt;&gt;(4.8, 4.5, 1));</div><div class="line">        chassis-&gt;SetBodyFixed(<span class="keyword">false</span>);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(chassis);</div><div class="line"></div><div class="line">        <span class="comment">// --- Right Front suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the car right-front spindle</span></div><div class="line">        spindleRF = std::make_shared&lt;ChBodyEasyBox&gt;(0.1, 0.4, 0.4, 1.0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">        spindleRF-&gt;SetPos(ChVector&lt;&gt;(1.3, 1, 1));</div><div class="line">        spindleRF-&gt;SetMass(8);</div><div class="line">        spindleRF-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(spindleRF);</div><div class="line"></div><div class="line">        <span class="comment">// ..the car right-front wheel</span></div><div class="line">        wheelRF = std::make_shared&lt;ChBodyEasyCylinder&gt;(0.45, 0.3, 1.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        wheelRF-&gt;SetPos(ChVector&lt;&gt;(1.5, 1, 1));</div><div class="line">        wheelRF-&gt;SetRot(chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">        wheelRF-&gt;SetMass(3);</div><div class="line">        wheelRF-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        wheelRF-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelRF-&gt;AddAsset(texture);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(wheelRF);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the spindle</span></div><div class="line">        link_revoluteRF = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// right, front, upper, 1</span></div><div class="line">        link_revoluteRF-&gt;Initialize(wheelRF, spindleRF,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(1.5, 1, 1), chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteRF);</div><div class="line"></div><div class="line">        <span class="comment">// .. impose distance between two parts (as a massless rod with two spherical joints at the end)</span></div><div class="line">        link_distRFU1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, front, upper, 1</span></div><div class="line">        link_distRFU1-&gt;Initialize(chassis, spindleRF, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.2, 1.2),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 1.2, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRFU1);</div><div class="line"></div><div class="line">        link_distRFU2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, front, upper, 2</span></div><div class="line">        link_distRFU2-&gt;Initialize(chassis, spindleRF, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.2, 0.8),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 1.2, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRFU2);</div><div class="line"></div><div class="line">        link_distRFL1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, front, lower, 1</span></div><div class="line">        link_distRFL1-&gt;Initialize(chassis, spindleRF, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 0.8, 1.2),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 0.8, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRFL1);</div><div class="line"></div><div class="line">        link_distRFL2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, front, lower, 2</span></div><div class="line">        link_distRFL2-&gt;Initialize(chassis, spindleRF, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 0.8, 0.8),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 0.8, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRFL2);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the spring between the truss and the spindle</span></div><div class="line">        link_springRF = std::make_shared&lt;ChLinkSpring&gt;();</div><div class="line">        link_springRF-&gt;Initialize(chassis, spindleRF, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.2, 1.0),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 0.8, 1));</div><div class="line">        link_springRF-&gt;Set_SpringK(28300);</div><div class="line">        link_springRF-&gt;Set_SpringR(80);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_springRF);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the rod for steering the wheel</span></div><div class="line">        link_distRSTEER = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right steer</span></div><div class="line">        link_distRSTEER-&gt;Initialize(chassis, spindleRF, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.21, 1.4),</div><div class="line">                                    ChVector&lt;&gt;(1.25, 1.21, 1.3));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRSTEER);</div><div class="line"></div><div class="line">        <span class="comment">// --- Left Front suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the car right-front spindle</span></div><div class="line">        spindleLF = std::make_shared&lt;ChBodyEasyBox&gt;(0.1, 0.4, 0.4, 1.0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">        spindleLF-&gt;SetPos(ChVector&lt;&gt;(-1.3, 1, 1));</div><div class="line">        spindleLF-&gt;SetMass(8);</div><div class="line">        spindleLF-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(spindleLF);</div><div class="line"></div><div class="line">        <span class="comment">// ..the car left-front wheel</span></div><div class="line">        wheelLF = std::make_shared&lt;ChBodyEasyCylinder&gt;(0.45, 0.3, 1.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        wheelLF-&gt;SetPos(ChVector&lt;&gt;(-1.5, 1, 1));</div><div class="line">        wheelLF-&gt;SetRot(chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">        wheelLF-&gt;SetMass(3);</div><div class="line">        wheelLF-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        wheelLF-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelLF-&gt;AddAsset(texture);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(wheelLF);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the spindle</span></div><div class="line">        link_revoluteLF = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// left, front, upper, 1</span></div><div class="line">        link_revoluteLF-&gt;Initialize(wheelLF, spindleLF,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(-1.5, 1, 1), chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteLF);</div><div class="line"></div><div class="line">        <span class="comment">// .. impose distance between two parts (as a massless rod with two spherical joints at the end)</span></div><div class="line">        link_distLFU1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, front, upper, 1</span></div><div class="line">        link_distLFU1-&gt;Initialize(chassis, spindleLF, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.2, 1.2),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 1.2, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLFU1);</div><div class="line"></div><div class="line">        link_distLFU2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, front, upper, 2</span></div><div class="line">        link_distLFU2-&gt;Initialize(chassis, spindleLF, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.2, 0.8),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 1.2, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLFU2);</div><div class="line"></div><div class="line">        link_distLFL1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, front, lower, 1</span></div><div class="line">        link_distLFL1-&gt;Initialize(chassis, spindleLF, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 0.8, 1.2),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 0.8, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLFL1);</div><div class="line"></div><div class="line">        link_distLFL2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, front, lower, 2</span></div><div class="line">        link_distLFL2-&gt;Initialize(chassis, spindleLF, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 0.8, 0.8),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 0.8, 1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLFL2);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the spring between the truss and the spindle</span></div><div class="line">        link_springLF = std::make_shared&lt;ChLinkSpring&gt;();</div><div class="line">        link_springLF-&gt;Initialize(chassis, spindleLF, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.2, 1.0),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 0.8, 1));</div><div class="line">        link_springLF-&gt;Set_SpringK(28300);</div><div class="line">        link_springLF-&gt;Set_SpringR(80);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_springLF);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the rod for steering the wheel</span></div><div class="line">        link_distLSTEER = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right steer</span></div><div class="line">        link_distLSTEER-&gt;Initialize(chassis, spindleLF, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.21, 1.4),</div><div class="line">                                    ChVector&lt;&gt;(-1.25, 1.21, 1.3));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLSTEER);</div><div class="line"></div><div class="line">        <span class="comment">// --- Right Back suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the car right-back spindle</span></div><div class="line">        spindleRB = std::make_shared&lt;ChBodyEasyBox&gt;(0.1, 0.4, 0.4, 1.0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">        spindleRB-&gt;SetPos(ChVector&lt;&gt;(1.3, 1, -1));</div><div class="line">        spindleRB-&gt;SetMass(8);</div><div class="line">        spindleRB-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(spindleRB);</div><div class="line"></div><div class="line">        <span class="comment">// ..the car right-back wheel</span></div><div class="line">        wheelRB = std::make_shared&lt;ChBodyEasyCylinder&gt;(0.45, 0.3, 1.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        wheelRB-&gt;SetPos(ChVector&lt;&gt;(1.5, 1, -1));</div><div class="line">        wheelRB-&gt;SetRot(chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">        wheelRB-&gt;SetMass(3);</div><div class="line">        wheelRB-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        wheelRB-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelRB-&gt;AddAsset(texture);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(wheelRB);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the spindle</span></div><div class="line">        link_revoluteRB = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// right, back, upper, 1</span></div><div class="line">        link_revoluteRB-&gt;Initialize(wheelRB, spindleRB,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(1.5, 1, -1), chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteRB);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the motor transmission joint between the wheel and the truss (assuming small changes of alignment)</span></div><div class="line">        link_engineR = std::make_shared&lt;ChLinkEngine&gt;();</div><div class="line">        link_engineR-&gt;Initialize(wheelRB, chassis,</div><div class="line">                                 <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(1.5, 1, -1), chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        link_engineR-&gt;Set_shaft_mode(<a class="code" href="classchrono_1_1_ch_link_engine.html#ac98a88a282435b5459d1fc656319939ea5efc5761ad6e67b6f15c37a43910253b">ChLinkEngine::ENG_SHAFT_CARDANO</a>);  <span class="comment">// approx as a double Rzeppa joint</span></div><div class="line">        link_engineR-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_TORQUE);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_engineR);</div><div class="line"></div><div class="line">        <span class="comment">// .. impose distance between two parts (as a massless rod with two spherical joints at the end)</span></div><div class="line">        link_distRBU1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, back, upper, 1</span></div><div class="line">        link_distRBU1-&gt;Initialize(chassis, spindleRB, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.2, -1.2),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 1.2, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRBU1);</div><div class="line"></div><div class="line">        link_distRBU2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, back, upper, 2</span></div><div class="line">        link_distRBU2-&gt;Initialize(chassis, spindleRB, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.2, -0.8),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 1.2, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRBU2);</div><div class="line"></div><div class="line">        link_distRBL1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, back, lower, 1</span></div><div class="line">        link_distRBL1-&gt;Initialize(chassis, spindleRB, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 0.8, -1.2),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 0.8, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRBL1);</div><div class="line"></div><div class="line">        link_distRBL2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right, back, lower, 2</span></div><div class="line">        link_distRBL2-&gt;Initialize(chassis, spindleRB, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 0.8, -0.8),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 0.8, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRBL2);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the spring between the truss and the spindle</span></div><div class="line">        link_springRB = std::make_shared&lt;ChLinkSpring&gt;();</div><div class="line">        link_springRB-&gt;Initialize(chassis, spindleRB, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.2, -1.0),</div><div class="line">                                  ChVector&lt;&gt;(1.25, 0.8, -1));</div><div class="line">        link_springRB-&gt;Set_SpringK(28300);</div><div class="line">        link_springRB-&gt;Set_SpringR(80);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_springRB);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the rod for avoid the steering of the wheel</span></div><div class="line">        link_distRBlat = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right rod</span></div><div class="line">        link_distRBlat-&gt;Initialize(chassis, spindleRB, <span class="keyword">false</span>, ChVector&lt;&gt;(0.5, 1.21, -1.4),</div><div class="line">                                   ChVector&lt;&gt;(1.25, 1.21, -1.3));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distRBlat);</div><div class="line"></div><div class="line">        <span class="comment">// --- Left Back suspension ---</span></div><div class="line"></div><div class="line">        <span class="comment">// ..the car right-back spindle</span></div><div class="line">        spindleLB = std::make_shared&lt;ChBodyEasyBox&gt;(0.1, 0.4, 0.4, 1.0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">        spindleLB-&gt;SetPos(ChVector&lt;&gt;(-1.3, 1, -1));</div><div class="line">        spindleLB-&gt;SetMass(8);</div><div class="line">        spindleLB-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(spindleLB);</div><div class="line"></div><div class="line">        <span class="comment">// ..the car left-back wheel</span></div><div class="line">        wheelLB = std::make_shared&lt;ChBodyEasyCylinder&gt;(0.45, 0.3, 1.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        wheelLB-&gt;SetPos(ChVector&lt;&gt;(-1.5, 1, -1));</div><div class="line">        wheelLB-&gt;SetRot(chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">        wheelLB-&gt;SetMass(3);</div><div class="line">        wheelLB-&gt;SetInertiaXX(ChVector&lt;&gt;(0.2, 0.2, 0.2));</div><div class="line">        wheelLB-&gt;GetMaterialSurface()-&gt;SetFriction(1.0);</div><div class="line">        wheelLB-&gt;AddAsset(texture);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(wheelLB);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the revolute joint between the wheel and the spindle</span></div><div class="line">        link_revoluteLB = std::make_shared&lt;ChLinkLockRevolute&gt;();  <span class="comment">// left, back, upper, 1</span></div><div class="line">        link_revoluteLB-&gt;Initialize(wheelLB, spindleLB,</div><div class="line">                                    <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(-1.5, 1, -1), chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteLB);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the motor transmission joint between the wheel and the truss (assuming small changes of alignment)</span></div><div class="line">        link_engineL = std::make_shared&lt;ChLinkEngine&gt;();</div><div class="line">        link_engineL-&gt;Initialize(wheelLB, chassis,</div><div class="line">                                 <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(-1.5, 1, -1), chrono::Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">        link_engineL-&gt;Set_shaft_mode(<a class="code" href="classchrono_1_1_ch_link_engine.html#ac98a88a282435b5459d1fc656319939ea5efc5761ad6e67b6f15c37a43910253b">ChLinkEngine::ENG_SHAFT_CARDANO</a>);  <span class="comment">// approx as a double Rzeppa joint</span></div><div class="line">        link_engineL-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_TORQUE);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_engineL);</div><div class="line"></div><div class="line">        <span class="comment">// .. impose distance between two parts (as a massless rod with two spherical joints at the end)</span></div><div class="line">        link_distLBU1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, front, upper, 1</span></div><div class="line">        link_distLBU1-&gt;Initialize(chassis, spindleLB, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.2, -1.2),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 1.2, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLBU1);</div><div class="line"></div><div class="line">        link_distLBU2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, back, upper, 2</span></div><div class="line">        link_distLBU2-&gt;Initialize(chassis, spindleLB, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.2, -0.8),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 1.2, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLBU2);</div><div class="line"></div><div class="line">        link_distLBL1 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, back, lower, 1</span></div><div class="line">        link_distLBL1-&gt;Initialize(chassis, spindleLB, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 0.8, -1.2),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 0.8, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLBL1);</div><div class="line"></div><div class="line">        link_distLBL2 = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// left, back, lower, 2</span></div><div class="line">        link_distLBL2-&gt;Initialize(chassis, spindleLB, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 0.8, -0.8),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 0.8, -1));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLBL2);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the spring between the truss and the spindle</span></div><div class="line">        link_springLB = std::make_shared&lt;ChLinkSpring&gt;();</div><div class="line">        link_springLB-&gt;Initialize(chassis, spindleLB, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.2, -1.0),</div><div class="line">                                  ChVector&lt;&gt;(-1.25, 0.8, -1));</div><div class="line">        link_springLB-&gt;Set_SpringK(28300);</div><div class="line">        link_springLB-&gt;Set_SpringR(80);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_springLB);</div><div class="line"></div><div class="line">        <span class="comment">// .. create the rod for avoid the steering of the wheel</span></div><div class="line">        link_distLBlat = std::make_shared&lt;ChLinkDistance&gt;();  <span class="comment">// right</span></div><div class="line">        link_distLBlat-&gt;Initialize(chassis, spindleLB, <span class="keyword">false</span>, ChVector&lt;&gt;(-0.5, 1.21, -1.4),</div><div class="line">                                   ChVector&lt;&gt;(-1.25, 1.21, -1.3));</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_distLBlat);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Delete the car object, deleting also all bodies corresponding to</span></div><div class="line">    <span class="comment">// the various parts and removing them from the physical system.  Also</span></div><div class="line">    <span class="comment">// removes constraints from the system.</span></div><div class="line">    ~MySimpleCar() {</div><div class="line">        <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>* mysystem = spindleRF-&gt;<a class="code" href="classchrono_1_1_ch_physics_item.html#a87da1034f53c53e8971259dd269bdfe0">GetSystem</a>();  <span class="comment">// trick to get the system here</span></div><div class="line">        <span class="comment">// When a ChBodySceneNode is removed via -&gt;remove() from Irrlicht 3D scene manager,</span></div><div class="line">        <span class="comment">// it is also automatically removed from the ChSystem (the ChSystem::RemoveBody() is</span></div><div class="line">        <span class="comment">// automatically called at Irrlicht node deletion - see ChBodySceneNode.h ).</span></div><div class="line"></div><div class="line">        <span class="comment">// For links, just remove them from the ChSystem using ChSystem::RemoveLink()</span></div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_revoluteRF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRFU1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRFU2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRFL1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRFL2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_springRF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRSTEER);</div><div class="line"></div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_revoluteLF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLFU1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLFU2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLFL1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLFL2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_springLF);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLSTEER);</div><div class="line"></div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_revoluteRB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRBU1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRBU2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRBL1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRBL2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_springRB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distRBlat);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_engineR);</div><div class="line"></div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_revoluteLB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLBU1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLBU2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLBL1);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLBL2);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_springLB);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_distLBlat);</div><div class="line">        mysystem-&gt;<a class="code" href="classchrono_1_1_ch_assembly.html#ac123628156d7336fb38957736f08b1b2">RemoveLink</a>(link_engineL);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// This can be used, at each time step, to compute the actual value of torque</span></div><div class="line">    <span class="comment">// transmitted to the wheels, according to gas throttle / speed / gear value.</span></div><div class="line">    <span class="comment">// The following is a very simplified model (the torque curve of the motor is linear</span></div><div class="line">    <span class="comment">// and no latency or inertial or clutch effects in gear train are considered.)</span></div><div class="line">    <span class="keywordtype">double</span> ComputeWheelTorque() {</div><div class="line">        <span class="comment">// Assume clutch is never used. Given the kinematics of differential,</span></div><div class="line">        <span class="comment">// the speed of the engine transmission shaft is the average of the two wheel speeds,</span></div><div class="line">        <span class="comment">// multiplied the conic gear transmission ratio inversed:</span></div><div class="line">        <span class="keywordtype">double</span> shaftspeed = (1.0 / this-&gt;conic_tau) * 0.5 *</div><div class="line">                            (this-&gt;link_engineL-&gt;Get_mot_rot_dt() + this-&gt;link_engineR-&gt;Get_mot_rot_dt());</div><div class="line">        <span class="comment">// The motorspeed is the shaft speed multiplied by gear ratio inversed:</span></div><div class="line">        <span class="keywordtype">double</span> motorspeed = (1.0 / this-&gt;gear_tau) * shaftspeed;</div><div class="line">        <span class="comment">// The torque depends on speed-torque curve of the motor: here we assume a</span></div><div class="line">        <span class="comment">// very simplified model a bit like in DC motors:</span></div><div class="line">        <span class="keywordtype">double</span> motortorque = max_motor_torque - motorspeed * (max_motor_torque / max_motor_speed);</div><div class="line">        <span class="comment">// Motor torque is linearly modulated by throttle gas value:</span></div><div class="line">        motortorque = motortorque * this-&gt;throttle;</div><div class="line">        <span class="comment">// The torque at motor shaft:</span></div><div class="line">        <span class="keywordtype">double</span> shafttorque = motortorque * (1.0 / this-&gt;gear_tau);</div><div class="line">        <span class="comment">// The torque at wheels - for each wheel, given the differential transmission,</span></div><div class="line">        <span class="comment">// it is half of the shaft torque  (multiplied the conic gear transmission ratio)</span></div><div class="line">        <span class="keywordtype">double</span> singlewheeltorque = 0.5 * shafttorque * (1.0 / this-&gt;conic_tau);</div><div class="line">        <span class="comment">// Set the wheel torque in both &#39;engine&#39; links, connecting the wheels to the truss;</span></div><div class="line">        <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(link_engineL-&gt;Get_tor_funct()))</div><div class="line">            mfun-&gt;Set_yconst(singlewheeltorque);</div><div class="line">        <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(link_engineR-&gt;Get_tor_funct()))</div><div class="line">            mfun-&gt;Set_yconst(singlewheeltorque);</div><div class="line">        <span class="comment">// debug:print infos on screen:</span></div><div class="line">        <span class="comment">// GetLog() &lt;&lt; &quot;motor torque=&quot;&lt;&lt; motortorque&lt;&lt; &quot;  speed=&quot; &lt;&lt; motorspeed &lt;&lt; &quot;  wheel torqe=&quot; &lt;&lt; singlewheeltorque</span></div><div class="line">        <span class="comment">// &lt;&lt;&quot;\n&quot;;</span></div><div class="line">        <span class="comment">// If needed, return also the value of wheel torque:</span></div><div class="line">        <span class="keywordflow">return</span> singlewheeltorque;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// Define a MyEventReceiver class which will be used to manage input</span></div><div class="line"><span class="comment">// from the GUI graphical user interface (the interface will</span></div><div class="line"><span class="comment">// be created with the basic -yet flexible- platform</span></div><div class="line"><span class="comment">// independent toolset of Irrlicht).</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>MyEventReceiver : <span class="keyword">public</span> IEventReceiver {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    MyEventReceiver(<a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>* asystem, IrrlichtDevice* adevice, MySimpleCar* acar) {</div><div class="line">        <span class="comment">// store pointer to physical system &amp; other stuff so we can tweak them by user keyboard</span></div><div class="line">        msystem = asystem;</div><div class="line">        mdevice = adevice;</div><div class="line">        mcar = acar;</div><div class="line"></div><div class="line">        adevice-&gt;setEventReceiver(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI slider to control gas throttle via mouse</span></div><div class="line">        scrollbar_throttle = mdevice-&gt;getGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(10, 85, 150, 100), 0, 100);</div><div class="line">        scrollbar_throttle-&gt;setMax(100);</div><div class="line">        scrollbar_throttle-&gt;setPos(0);</div><div class="line">        text_throttle = mdevice-&gt;getGUIEnvironment()-&gt;addStaticText(L<span class="stringliteral">&quot;Throttle&quot;</span>, rect&lt;s32&gt;(150, 85, 250, 100), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI slider to control steering via mouse</span></div><div class="line">        scrollbar_steer = mdevice-&gt;getGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(10, 105, 150, 120), 0, 101);</div><div class="line">        scrollbar_steer-&gt;setMax(100);</div><div class="line">        scrollbar_steer-&gt;setPos(50);</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI text and GUI slider to control the stiffness</span></div><div class="line">        scrollbar_FspringK = mdevice-&gt;getGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(10, 125, 150, 140), 0, 102);</div><div class="line">        scrollbar_FspringK-&gt;setMax(100);</div><div class="line">        scrollbar_FspringK-&gt;setPos((s32)(50 + 50.0 * (acar-&gt;link_springRF-&gt;Get_SpringK() - 80000.0) / 60000.0));</div><div class="line">        text_FspringK =</div><div class="line">            mdevice-&gt;getGUIEnvironment()-&gt;addStaticText(L<span class="stringliteral">&quot;Spring K [N/m]:&quot;</span>, rect&lt;s32&gt;(150, 125, 250, 140), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI text and GUI slider to control the damping</span></div><div class="line">        scrollbar_FdamperR = mdevice-&gt;getGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(10, 145, 150, 160), 0, 103);</div><div class="line">        scrollbar_FdamperR-&gt;setMax(100);</div><div class="line">        scrollbar_FdamperR-&gt;setPos((s32)(50 + 50.0 * (acar-&gt;link_springRF-&gt;Get_SpringR() - 800.0) / 800.0));</div><div class="line">        text_FdamperR =</div><div class="line">            mdevice-&gt;getGUIEnvironment()-&gt;addStaticText(L<span class="stringliteral">&quot;Damper R [Ns/m]:&quot;</span>, rect&lt;s32&gt;(150, 145, 250, 160), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ..add a GUI text and GUI slider to control the original undeformed spring length</span></div><div class="line">        scrollbar_FspringL = mdevice-&gt;getGUIEnvironment()-&gt;addScrollBar(<span class="keyword">true</span>, rect&lt;s32&gt;(10, 165, 150, 180), 0, 104);</div><div class="line">        scrollbar_FspringL-&gt;setMax(100);</div><div class="line">        scrollbar_FspringL-&gt;setPos((s32)(50 + 50.0 * (acar-&gt;link_springRF-&gt;Get_SpringRestLength() - 0.9) / 0.1));</div><div class="line">        text_FspringL =</div><div class="line">            mdevice-&gt;getGUIEnvironment()-&gt;addStaticText(L<span class="stringliteral">&quot;Spring L [m]:&quot;</span>, rect&lt;s32&gt;(150, 165, 250, 180), <span class="keyword">false</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">bool</span> OnEvent(<span class="keyword">const</span> SEvent&amp; event) {</div><div class="line">        <span class="comment">// check if user moved the sliders with mouse..</span></div><div class="line">        <span class="keywordflow">if</span> (event.EventType == EET_GUI_EVENT) {</div><div class="line">            s32 <span class="keywordtype">id</span> = <span class="keyword">event</span>.GUIEvent.Caller-&gt;getID();</div><div class="line">            IGUIEnvironment* env = mdevice-&gt;getGUIEnvironment();</div><div class="line"></div><div class="line">            <span class="keywordflow">switch</span> (event.GUIEvent.EventType) {</div><div class="line">                <span class="keywordflow">case</span> EGET_SCROLL_BAR_CHANGED:</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 101)  <span class="comment">// id of &#39;steer&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newsteer = 0.18 * (((double)(pos - 50)) / 50.0);</div><div class="line">                        <span class="comment">// set the steering, moving horizontally the endpoints of the steer rod endpoint on truss.</span></div><div class="line">                        this-&gt;mcar-&gt;link_distRSTEER-&gt;SetEndPoint1Rel(ChVector&lt;&gt;(0.5 + newsteer, 0.21, 1.4));</div><div class="line">                        this-&gt;mcar-&gt;link_distLSTEER-&gt;SetEndPoint1Rel(ChVector&lt;&gt;(-0.5 + newsteer, 0.21, 1.4));</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 102)  <span class="comment">// id of &#39;spring stiffness&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newstiff = 80000 + 60000 * (((double)(pos - 50)) / 50.0);</div><div class="line">                        <span class="comment">// set the stiffness of all 4 springs</span></div><div class="line">                        this-&gt;mcar-&gt;link_springRF-&gt;Set_SpringK(newstiff);</div><div class="line">                        this-&gt;mcar-&gt;link_springLF-&gt;Set_SpringK(newstiff);</div><div class="line">                        this-&gt;mcar-&gt;link_springRB-&gt;Set_SpringK(newstiff);</div><div class="line">                        this-&gt;mcar-&gt;link_springLB-&gt;Set_SpringK(newstiff);</div><div class="line"></div><div class="line">                        <span class="comment">// show stiffness as formatted text in interface screen</span></div><div class="line">                        <span class="keywordtype">char</span> message[50];</div><div class="line">                        sprintf(message, <span class="stringliteral">&quot;Spring K [N/m]: %g&quot;</span>, newstiff);</div><div class="line">                        text_FspringK-&gt;setText(core::stringw(message).c_str());</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 103)  <span class="comment">// id of &#39;damping&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newdamping = 800 + 800 * (((double)(pos - 50)) / 50.0);</div><div class="line">                        <span class="comment">// set the damping of all 4 springs</span></div><div class="line">                        this-&gt;mcar-&gt;link_springRF-&gt;Set_SpringR(newdamping);</div><div class="line">                        this-&gt;mcar-&gt;link_springLF-&gt;Set_SpringR(newdamping);</div><div class="line">                        this-&gt;mcar-&gt;link_springRB-&gt;Set_SpringR(newdamping);</div><div class="line">                        this-&gt;mcar-&gt;link_springLB-&gt;Set_SpringR(newdamping);</div><div class="line"></div><div class="line">                        <span class="comment">// show stiffness as formatted text in interface screen</span></div><div class="line">                        <span class="keywordtype">char</span> message[50];</div><div class="line">                        sprintf(message, <span class="stringliteral">&quot;Damping R [Ns/m]: %g&quot;</span>, newdamping);</div><div class="line">                        text_FdamperR-&gt;setText(core::stringw(message).c_str());</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 104)  <span class="comment">// id of &#39;spring rest length&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newlength = 0.9 + 0.1 * (((double)(pos - 50)) / 50.0);</div><div class="line">                        <span class="comment">// set the rest length of all 4 springs</span></div><div class="line">                        this-&gt;mcar-&gt;link_springRF-&gt;Set_SpringRestLength(newlength);</div><div class="line">                        this-&gt;mcar-&gt;link_springLF-&gt;Set_SpringRestLength(newlength);</div><div class="line">                        this-&gt;mcar-&gt;link_springRB-&gt;Set_SpringRestLength(newlength);</div><div class="line">                        this-&gt;mcar-&gt;link_springLB-&gt;Set_SpringRestLength(newlength);</div><div class="line"></div><div class="line">                        <span class="comment">// show stiffness as formatted text in interface screen</span></div><div class="line">                        <span class="keywordtype">char</span> message[50];</div><div class="line">                        sprintf(message, <span class="stringliteral">&quot;Spring L [m]: %g&quot;</span>, newlength);</div><div class="line">                        text_FspringL-&gt;setText(core::stringw(message).c_str());</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 100)  <span class="comment">// id of &#39;throttle&#39; slider..</span></div><div class="line">                    {</div><div class="line">                        s32 pos = ((IGUIScrollBar*)event.GUIEvent.Caller)-&gt;getPos();</div><div class="line">                        <span class="keywordtype">double</span> newthrottle = ((double)(pos)) / 100.0;</div><div class="line">                        <span class="comment">// Set the throttle value of car (the torque transmitted</span></div><div class="line">                        <span class="comment">// to wheels depends on throttle, speed, transmission gear, so</span></div><div class="line">                        <span class="comment">// it will sent to the link_engineR and link_engineL only when</span></div><div class="line">                        <span class="comment">// computed by MySimplifiedCar::ComputeWheelTorque(),</span></div><div class="line">                        this-&gt;mcar-&gt;throttle = newthrottle;</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a>* msystem;</div><div class="line">    IrrlichtDevice* mdevice;</div><div class="line">    MySimpleCar* mcar;</div><div class="line"></div><div class="line">    IGUIScrollBar* scrollbar_steer;</div><div class="line">    IGUIStaticText* text_FspringK;</div><div class="line">    IGUIScrollBar* scrollbar_FspringK;</div><div class="line">    IGUIStaticText* text_FdamperR;</div><div class="line">    IGUIScrollBar* scrollbar_FdamperR;</div><div class="line">    IGUIStaticText* text_FspringL;</div><div class="line">    IGUIScrollBar* scrollbar_FspringL;</div><div class="line">    IGUIStaticText* text_throttle;</div><div class="line">    IGUIScrollBar* scrollbar_throttle;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// This is the program which is executed</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// HERE YOU CREATE THE MECHANICAL SYSTEM OF CHRONO...</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">// 1- Create a ChronoENGINE physical system: all bodies and constraints</span></div><div class="line">    <span class="comment">//    will be handled by this ChSystem object.</span></div><div class="line">    <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> my_system;</div><div class="line"></div><div class="line">    <span class="comment">// 2.- Create the Irrlicht visualization.</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app.html">ChIrrApp</a> application(&amp;my_system, L<span class="stringliteral">&quot;Simple vehicle suspension&quot;</span>, core::dimension2d&lt;u32&gt;(640, 480), <span class="keyword">false</span>);</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#ae185d295a9a02352688166c2c6665234">ChIrrWizard::add_typical_Logo</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#ab3087fe4418963f09727a91f43562129">ChIrrWizard::add_typical_Sky</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#aa990918e4e1113997fee29ba82083ab1">ChIrrWizard::add_typical_Lights</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#add550a0cc283f166db49d39e50f76c0b">ChIrrWizard::add_typical_Camera</a>(application.GetDevice(), core::vector3df(0, 0, -6));</div><div class="line"></div><div class="line">    <span class="comment">// 3- Create the rigid bodies of the simpified car suspension mechanical system</span></div><div class="line">    <span class="comment">//   maybe setting position/mass/inertias of</span></div><div class="line">    <span class="comment">//   their center of mass (COG) etc.</span></div><div class="line"></div><div class="line">    <span class="comment">// ..the world</span></div><div class="line">    <span class="keyword">auto</span> texture = std::make_shared&lt;ChTexture&gt;();</div><div class="line">    texture-&gt;SetTextureFilename(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;blu.png&quot;</span>));</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> my_ground = std::make_shared&lt;ChBodyEasyBox&gt;(60, 2, 60, 1.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">    my_ground-&gt;SetPos(ChVector&lt;&gt;(0, -1, 0));</div><div class="line">    my_ground-&gt;SetBodyFixed(<span class="keyword">true</span>);</div><div class="line">    my_ground-&gt;GetMaterialSurface()-&gt;SetSfriction(1.0);</div><div class="line">    my_ground-&gt;GetMaterialSurface()-&gt;SetKfriction(1.0);</div><div class="line">    my_ground-&gt;AddAsset(texture);</div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(my_ground);</div><div class="line"></div><div class="line">    <span class="comment">// ..some obstacles on the ground:</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div><div class="line">        <span class="keyword">auto</span> my_obstacle = std::make_shared&lt;ChBodyEasyBox&gt;(1, 0.1, 0.5, 60.0, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">        my_obstacle-&gt;SetPos(ChVector&lt;&gt;(20 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>(), 2, 20 * <a class="code" href="namespacechrono.html#adea45eb9ba968996caccfd982f39dad2">ChRandom</a>()));</div><div class="line">        my_obstacle-&gt;SetMass(3);</div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#aeb86b4df59dc82ad4d5a969b45e159b1">AddBody</a>(my_obstacle);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// ..the car (this class - see above - is a &#39;set&#39; of bodies and links, automatically added at creation)</span></div><div class="line">    MySimpleCar* mycar = <span class="keyword">new</span> MySimpleCar(my_system, application.GetSceneManager(), application.GetVideoDriver());</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// CREATE A CUSTOM MATERIAL COMBINER</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">//  Suppose you want that some places have different friction coefficient values,</span></div><div class="line">    <span class="comment">//  how can you do this? By default, friction is the average of friction coefficient</span></div><div class="line">    <span class="comment">//  of the two bodies in contact, but you can create an &#39;callback object&#39; inherited from the</span></div><div class="line">    <span class="comment">//  a ChCustomCollisionPointCallback class. This will be called per each contact point, and</span></div><div class="line">    <span class="comment">//  it can modify the friction as in the very simple example below:</span></div><div class="line"></div><div class="line">    <span class="keyword">class </span>MyContactCallback : <span class="keyword">public</span> <a class="code" href="classchrono_1_1_ch_system_1_1_ch_custom_collision_point_callback.html">ChSystem::ChCustomCollisionPointCallback</a> {</div><div class="line">      <span class="keyword">public</span>:</div><div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> ContactCallback(</div><div class="line">            <span class="keyword">const</span> <a class="code" href="classchrono_1_1collision_1_1_ch_collision_info.html">collision::ChCollisionInfo</a>&amp; mcontactinfo,  </div><div class="line">            <a class="code" href="classchrono_1_1_ch_material_couple.html">ChMaterialCouple</a>&amp; material)                      </div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (mcontactinfo.<a class="code" href="classchrono_1_1collision_1_1_ch_collision_info.html#a73397ae482797b44b8323b0aafb10151">vpA</a>.x &gt; 0)</div><div class="line">                material.static_friction = 0.7f;  <span class="comment">// On the right of the plane, less friction...</span></div><div class="line">            <span class="keywordflow">else</span></div><div class="line">                material.static_friction = 1.0f;  <span class="comment">// On the left of the plane, more friction...</span></div><div class="line">        };</div><div class="line">    };</div><div class="line"></div><div class="line">    MyContactCallback mycontact_callback;                            <span class="comment">// create the callback object</span></div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_system.html#a1a1c2523c44550a2e4e77d5f5fc91011">SetCustomCollisionPointCallback</a>(&amp;mycontact_callback);  <span class="comment">// tell the system to use that callback.</span></div><div class="line"></div><div class="line">    <span class="comment">// Bind visualization assets.</span></div><div class="line">    application.AssetBindAll();</div><div class="line">    application.AssetUpdateAll();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// USER INTERFACE</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">// Create some graphical-user-interface (GUI) items to show on the screen.</span></div><div class="line">    <span class="comment">// This requires an event receiver object -see above.</span></div><div class="line">    MyEventReceiver receiver(&amp;my_system, application.GetDevice(), mycar);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// SETTINGS</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    my_system.<a class="code" href="classchrono_1_1_ch_system.html#a0fec5297a93785df11a4dd5409346f2c">SetMaxItersSolverSpeed</a>(20);  <span class="comment">// the higher, the easier to keep the constraints &#39;mounted&#39;.</span></div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// THE SOFT-REAL-TIME CYCLE, SHOWING THE SIMULATION</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">// This will help choosing an integration step which matches the</span></div><div class="line">    <span class="comment">// real-time step of the simulation..</span></div><div class="line">    <a class="code" href="classchrono_1_1_ch_realtime_step_timer.html">ChRealtimeStepTimer</a> m_realtime_timer;</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (application.GetDevice()-&gt;run()) {</div><div class="line">        <span class="comment">// Irrlicht must prepare frame to draw</span></div><div class="line">        application.BeginScene(<span class="keyword">true</span>, <span class="keyword">true</span>, SColor(255, 140, 161, 192));</div><div class="line"></div><div class="line">        <span class="comment">// Irrlicht now draws simple lines in 3D world representing a</span></div><div class="line">        <span class="comment">// skeleton of the mechanism, in this instant:</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// .. draw solid 3D items (boxes, cylinders, shapes) belonging to Irrlicht scene, if any</span></div><div class="line">        application.DrawAll();</div><div class="line"></div><div class="line">        <span class="comment">// .. draw a grid (rotated so that it&#39;s horizontal)</span></div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#aed2fa6dd02297539fa2bf0c08644d90e">ChIrrTools::drawGrid</a>(application.GetVideoDriver(), 2, 2, 30, 30, <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(0, 0.01, 0), Q_from_AngX(CH_C_PI_2)),</div><div class="line">                             video::SColor(255, 80, 130, 130), <span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <span class="comment">// .. draw GUI user interface items (sliders, buttons) belonging to Irrlicht screen, if any</span></div><div class="line">        application.GetIGUIEnvironment()-&gt;drawAll();</div><div class="line"></div><div class="line">        <span class="comment">// .. draw the distance constraints (the massless rods) as simplified lines</span></div><div class="line">        <span class="keyword">auto</span> iterlink = my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a4420fa2c371967f8fd68be4da7175570">Get_linklist</a>()-&gt;begin();</div><div class="line">        <span class="keywordflow">while</span> (iterlink != my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a4420fa2c371967f8fd68be4da7175570">Get_linklist</a>()-&gt;end()) {</div><div class="line">            <span class="keywordflow">if</span> (<span class="keyword">auto</span> mylinkdis = std::dynamic_pointer_cast&lt;ChLinkDistance&gt;(*iterlink))</div><div class="line">                <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#ac0844abf707003b0490c37e78de36651">ChIrrTools::drawSegment</a>(application.GetVideoDriver(), mylinkdis-&gt;GetEndPoint1Abs(), mylinkdis-&gt;GetEndPoint2Abs(),</div><div class="line">                                        video::SColor(255, 0, 20, 0), <span class="keyword">true</span>);</div><div class="line">            iterlink++;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// .. draw the spring constraints as simplified spring helix</span></div><div class="line">        iterlink = my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a4420fa2c371967f8fd68be4da7175570">Get_linklist</a>()-&gt;begin();</div><div class="line">        <span class="keywordflow">while</span> (iterlink != my_system.<a class="code" href="classchrono_1_1_ch_assembly.html#a4420fa2c371967f8fd68be4da7175570">Get_linklist</a>()-&gt;end()) {</div><div class="line">            <span class="keywordflow">if</span> (<span class="keyword">auto</span> mylinkspri = std::dynamic_pointer_cast&lt;ChLinkSpring&gt;(*iterlink))</div><div class="line">                <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#a282bfbfec9dfce3c4027424300660987">ChIrrTools::drawSpring</a>(application.GetVideoDriver(), 0.03, mylinkspri-&gt;GetEndPoint1Abs(), mylinkspri-&gt;GetEndPoint2Abs(),</div><div class="line">                                       video::SColor(255, 150, 20, 20), 80, 5, <span class="keyword">true</span>);</div><div class="line">            iterlink++;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// The torque applied to wheels, using the ChLinkEngine links between</span></div><div class="line">        <span class="comment">// wheels and truss, depends on many parameters (gear, throttle, etc):</span></div><div class="line">        mycar-&gt;ComputeWheelTorque();</div><div class="line"></div><div class="line">        <span class="comment">// HERE CHRONO INTEGRATION IS PERFORMED: THE</span></div><div class="line">        <span class="comment">// TIME OF THE SIMULATION ADVANCES FOR A SINGLE</span></div><div class="line">        <span class="comment">// STEP:</span></div><div class="line"></div><div class="line">        my_system.<a class="code" href="classchrono_1_1_ch_system.html#a552f40a0951fa8dc3c1e00900fd3b48c">DoStepDynamics</a>(m_realtime_timer.<a class="code" href="classchrono_1_1_ch_realtime_step_timer.html#ad8c043d898a7f7da153303aa48b9cf17">SuggestSimulationStep</a>(0.005));</div><div class="line"></div><div class="line">        <span class="comment">// Irrlicht must finish drawing the frame</span></div><div class="line">        application.EndScene();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (mycar)</div><div class="line">        <span class="keyword">delete</span> mycar;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 1 2016 15:43:11 for Project Chrono by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11 . <a href="mailto:info@projectchrono.org">Contact us</a> for issues related to this page. 
</small></address>
</body>
</html>
